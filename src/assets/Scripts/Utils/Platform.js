var Platform=cc.Class({properties:{_engineVersion:0,_basePath:"",_enviormentType:1,enviormentType_cocos:1,enviormentType_rrxiu:2,_pluginGameHelper:null,_gameColor:"",_gameThinColor:"",_gameSkins:{default:function(){return{images:{},audios:{},texts:{},jsons:{}}}},_gameMode:1,_gameLevel:1,_gameLevelTotal:12,_cocosResourcePath:""},ctor:function(){this._engineVersion=parseInt(cc.ENGINE_VERSION.split(".").join(""))},isRRX(){return this._enviormentType==this.enviormentType_rrxiu},canRRXEvent(){return!this._isEdit&&this.isRRX()},setPluginContext(e,t=null){this.setContext(e,t)},setContext(e){this._enviormentType=this.enviormentType_rrxiu,this._pluginContext=e,this._basePath=this._pluginContext._basePath,this._isEdit=this._pluginContext.isEdit,this._api=this._pluginContext.api,this._pluginGameHelper=this._pluginContext.pluginGameHelper,this._pluginGameHelper.gameMode&&(this._gameMode=this._pluginGameHelper.gameMode,console.log("\u6ce8\u5165\u5f53\u524d\u6e38\u620f\u6a21\u5f0f: "+this._gameMode),console.log(typeof this._gameMode)),this._pluginGameHelper.gameLevel&&(this._gameLevel=this._pluginGameHelper.gameLevel),this._pluginGameHelper.gameLevelTotal&&(this._gameLevelTotal=this._pluginGameHelper.gameLevelTotal)},getContext(){return this._pluginContext},getGameStrategyApi(){return this._pluginGameHelper.strategyEvent},getGameMode(){return console.log("\u83b7\u53d6\u5f53\u524d\u6e38\u620f\u6a21\u5f0f: "+this._gameMode),console.log(typeof this._gameMode),this._gameMode},getGameLevel(){return this._gameLevel},getGameLevelTotal(){return this._gameLevelTotal},async initPluginResource(e=null){let t=this.isRRX();console.log("\u662f\u5426\u662fRRX:"+t),await this.cocosEnviormentLoad(t),t&&await this.rrxiuEnviormentLoad(),e&&e()},async cocosEnviormentLoad(e){console.log("\u5f00\u59cb\u52a0\u8f7dCocos\u8d44\u6e90")},async rrxiuEnviormentLoad(){var e=this;return new Promise(function(t,o){let i=e.getGameAPI().themeDict;i?(e._gameSkins.texts=i.dict,console.log(i.courseStyle),e.getAllRemoteImageResource(i.courseStyle,function(o){e._gameSkins.images=o,e.getAllRemoteAudioResource(i.audioStyle,function(o){e._gameSkins.audios=o,e.loadGameResourceJson(function(o){e._gameSkins.jsons=o,t(e._gameSkins),console.info("\u6e38\u620f\u76ae\u80a4_gameSkins",e._gameSkins),setTimeout(()=>{e.isLoadOver()},500)})})})):o("\u89e3\u6790\u8d44\u6e90\u5931\u8d25")})},isLoadOver(){if(!this.canRRXEvent())return!0;this.getGameStrategyApi().isLoadOver()},getPluginFiles(e,t){return this.isRRX()?this.getContext().getFile(e,t):t+"/"+e},getAllRemoteImageResource(e,t){let o={};if(e&&0!=e.length){var i=this,s=0;(function n(){i.getRemoteImageResource(e[s].value,function(i){i&&(o[e[s].key]=i),++s>e.length-1?t&&t(o):n()})})()}else t&&t(o)},async getRemoteImageResource(e,t){console.log("\u52a0\u8f7d\u8fdc\u7a0b\u56fe\u7247\u5730\u5740:"+e),await this.loadRemoteResource(e,"image").then(e=>{t&&t(e)}).catch(()=>{t&&t()})},getAllRemoteAudioResource(e,t){let o={};if(e&&0!=e.length){var i=this,s=0;(function n(){i.getRemoteAudioResource(e[s].value,function(i){o[e[s].key]=i,++s>e.length-1?t&&t(o):n()})})()}else t&&t(o)},async getRemoteAudioResource(e,t){console.log("\u52a0\u8f7d\u8fdc\u7a0b\u97f3\u9891\u5730\u5740:"+e),await this.loadRemoteResource(e,"audio").then(e=>{t&&t(e)}).catch(()=>{t&&t()})},loadGameResourceJson(e){let t=[],o={};if(t&&0!=t.length){var i=this,s=0;(function n(){let a=i.getPluginFiles(t[s].src,"resource/assets")+"?v="+location.host;console.log(a),i.getResourceJson(a,function(i){o[t[s].id]=i,++s>t.length-1?e&&e(o):n()})})()}else e&&e(o)},async getRes(e,t="image",o=""){let i=this;return new Promise(function(s,n){if(i.isRRX())s(i.getGameSkins(e,t));else{switch(t){case"image":""==o&&(o="images");break;case"audio":""==o&&(o="audios")}i.loadLocalResource(o+"/"+e).then(e=>{s(e)}).catch(e=>{n(e)})}})},async loadRemoteResource(e,t="image"){var o=this;return new Promise(function(i,s){if(o._engineVersion>=300)cc.assetManager.loadRemote(e,function(e,t){e?(console.log(e,"\u52a0\u8f7d\u8fdc\u7a0b\u8d44\u6e90\u5931\u8d25"),s(e)):(console.log(t,"\u52a0\u8f7d\u8fdc\u7a0b\u8d44\u6e90\u6210\u529f"),i(texture))});else if(o._engineVersion>=247)cc.assetManager.loadRemote(e,function(e,t){e?(console.log(e,"\u52a0\u8f7d\u8fdc\u7a0b\u8d44\u6e90\u5931\u8d25"),s(e)):(console.log(t,"\u52a0\u8f7d\u8fdc\u7a0b\u8d44\u6e90\u6210\u529f"),i(texture))});else if(o._engineVersion>=200){var n=e;"image"==t&&(n={url:e,type:"png"}),cc.loader.load(n,function(e,t){e?(console.log(e,"\u52a0\u8f7d\u8fdc\u7a0b\u8d44\u6e90\u5931\u8d25"),s(e)):(console.log(t,"\u52a0\u8f7d\u8fdc\u7a0b\u8d44\u6e90\u6210\u529f"),i(t))})}})},async loadLocalResource(e){var t=this;return new Promise(function(o,i){t._engineVersion>=300?cc.resources.load(e,function(e,t){e?(console.log(e,"\u52a0\u8f7d\u672c\u5730\u8d44\u6e90\u5931\u8d25"),i(e)):o(t)}):t._engineVersion>=247?cc.resources.load(e,function(e,t){e?(console.log(e,"\u52a0\u8f7d\u672c\u5730\u8d44\u6e90\u5931\u8d25"),i(e)):o(t)}):t._engineVersion>=200&&cc.loader.loadRes(e,function(e,t){e?(console.log(e,"\u52a0\u8f7d\u672c\u5730\u8d44\u6e90\u5931\u8d25"),i(e)):(console.log(t,"\u52a0\u8f7d\u672c\u5730\u8d44\u6e90\u6210\u529f"),o(t))})})},getGameSkins(e,t="image"){if(this._gameSkins)switch(t){case"image":if(this._gameSkins.images&&this._gameSkins.images[e])return this._gameSkins.images[e];break;case"audio":if(this._gameSkins.audios&&this._gameSkins.audios[e])return this._gameSkins.audios[e];break;case"text":if(this._gameSkins.texts&&e)return this._gameSkins.texts[e];break;case"json":if(this._gameSkins.jsons&&this._gameSkins.jsons[e])return this._gameSkins.jsons[e]}return null},getColor(){return this._gameColor||(this.isRRX()?(this._gameColor=this.getGamePageApi().getBasicColor(),this._gameColor=GameUtils.color2Num(this._gameColor)):(this._gameColor="#d16b1e",this._gameColor=GameUtils.color2Num(this._gameColor))),this._gameColor},getThinColor(){return this._gameThinColor||(this._gameThinColor=GameUtils.color2Shade(this.getColor(),.4)),this._gameThinColor},getWireColor(){let e="#8fd6ff";if(this.isRRX()){let t="tx_wire";e=this.getGameSkins(t,"text").color}return GameUtils.color2Num(e)},startGame(){window.gameUtil.setGameStart(!0)},submitGameScore(e,t=1,o=0,i=""){if(console.log("\u63d0\u4ea4\u5206\u6570:"+e+", \u6e38\u620f\u8bc4\u661f:"+o),!this.isRRX())return console.log("\u8fd9\u662fCocos\u672c\u5730\u73af\u5883\uff0c\u8bf7\u81ea\u884c\u968f\u4fbf\u5904\u7406\u63d0\u4ea4\u5206\u6570\u903b\u8f91"),2==this.gameMode&&(this.gameLevel++,console.log("\u8fd9\u662f\u95ef\u5173\u6a21\u5f0f\uff0c\u63d0\u4ea4\u5206\u6570\u540e\u8fdb\u5165\u4e0b\u4e00\u5173"+this.gameLevel)),!0;this.getGameStrategyApi().addScore(e,{gameWin:t,gameGrade:o,memo:i})},showMsg(e){this.canMiniEvent()?this.getGamePageApi().infoMsg(e):alert(e)},getGameAPI(){return this._pluginGameHelper}});console.log("\u5f00\u59cb\u6302\u8f7dwindow.Platform"),window.platform=new Platform;