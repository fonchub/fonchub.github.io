window.__require=function t(e,i,n){function o(s,a){if(!i[s]){if(!e[s]){var r=s.split("/");if(r=r[r.length-1],!e[r]){var _="function"==typeof __require&&__require;if(!a&&_)return _(r,!0);if(c)return c(r,!0);throw new Error("Cannot find module '"+s+"'")}s=r}var h=i[s]={exports:{}};e[s][0].call(h.exports,function(t){return o(e[s][1][t]||t)},h,h.exports,t,e,i,n)}return i[s].exports}for(var c="function"==typeof __require&&__require,s=0;s<n.length;s++)o(n[s]);return o}({BgItem:[function(t,e){"use strict";cc._RF.push(e,"36677ltfcNFbZGeI09kkTxO","BgItem"),cc.Class({extends:cc.Component,properties:{m_n_bgday:cc.Node,m_n_bgnight:cc.Node},start:function(){var t=(new Date).getHours();this.m_n_bgday.active=t>=8&&t<=18,this.m_n_bgnight.active=t<8||t>18}}),cc._RF.pop()},{}],BgSetting:[function(t,e){"use strict";cc._RF.push(e,"49ca5JK7uVAzoTD1isE+1TU","BgSetting"),cc.Class({extends:cc.Component,properties:{},start:function(){var t=cc.winSize,e=this.node.getContentSize();this.node.scaleX=t.width/e.width,this.node.scaleY=t.height/e.height,window.adapt_scaleX=this.node.scaleX,window.adapt_scaleY=this.node.scaleY}}),cc._RF.pop()},{}],BigStepItem:[function(t,e,i){"use strict";cc._RF.push(e,"be69aicp1VM956W/yG6BxJU","BigStepItem"),Object.defineProperty(i,"__esModule",{value:!0});var n=cc._decorator,o=n.ccclass,c=n.property,s=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.m_sp_stepicon=null,e.m_sp_stepname=null,e.m_n_lock=null,e.m_l_condition=null,e.m_n_starlist=[],e}return __extends(e,t),e.prototype.start=function(){},e.prototype.updateData=function(t,e,i,n,o){if(void 0===o&&(o=0),t){this.node.color=cc.Color.WHITE.fromHEX(["#33ABEE","#33EEEE","#33EE94","#BAE789"][o]),this.m_sp_stepicon.spriteFrame=e,this.m_sp_stepname.spriteFrame=i;for(var c=0;c<this.m_n_starlist.length;c++)this.m_n_starlist[c].active=c<t.star;this.m_n_lock.active=t.lv>n,t.lv>n?(this.m_l_condition.node.y=-33,this.m_l_condition.string=cc.js.formatStr("\u9700\u901a\u5173%d\u5173",t.lv)):(this.m_l_condition.node.y=0,this.m_l_condition.string="\u5df2\u83b7\u5f97")}},__decorate([c(cc.Sprite)],e.prototype,"m_sp_stepicon",void 0),__decorate([c(cc.Sprite)],e.prototype,"m_sp_stepname",void 0),__decorate([c(cc.Node)],e.prototype,"m_n_lock",void 0),__decorate([c(cc.Label)],e.prototype,"m_l_condition",void 0),__decorate([c([cc.Node])],e.prototype,"m_n_starlist",void 0),__decorate([o],e)}(cc.Component);i.default=s,cc._RF.pop()},{}],BlockBGItem:[function(t,e){"use strict";cc._RF.push(e,"1f50fDEmn1NhKZ+3jOght5I","BlockBGItem"),cc.Class({extends:cc.Component,properties:{m_n_bright:cc.Node},onLoad:function(){},start:function(){},setBrightVisible:function(t,e){this.m_n_bright.active=t,e&&(this.m_n_bright.color=cc.Color.WHITE.fromHEX(e))}}),cc._RF.pop()},{}],BlockItem:[function(t,e){"use strict";cc._RF.push(e,"e7b1eTTmSVB34RRUkqvGDNv","BlockItem"),cc.Class({extends:cc.Component,properties:{_hp:0,_type:0,_tag:0,m_sp_strong:cc.Node,m_sp_hurt:cc.Node},onLoad:function(){},start:function(){},initType:function(t,e){this._type=t,this._tag=e,window.BLOCKLIST[t][e]&&(this._hp=window.BLOCKLIST[t][e].hp),this.node.scale=1,this.node.opacity=255,this._tostrong=!1,this.m_sp_strong.active=!1,this.m_sp_hurt.active=!1},showHurt:function(t){1==this._type&&(this.m_sp_hurt.active=!0,this.m_sp_hurt.getComponent(cc.Sprite).spriteFrame=t)},setSpriteFrame:function(t){this.node.getComponent(cc.Sprite).spriteFrame=t},getHp:function(){return this._hp},getTag:function(){return this._tag},addStrong:function(){var t=this;return!this._tostrong&&(this._tostrong=!0,this._hp=this._hp+this._hp,this.m_sp_strong.scale=0,this.m_sp_strong.active=!0,this.m_sp_strong.stopAllActions(),this.m_sp_strong.runAction(cc.sequence(cc.scaleTo(.5,1,1).easing(cc.easeIn(2)),cc.callFunc(function(){t.m_sp_strong.runAction(cc.repeatForever(cc.sequence(cc.scaleTo(.5,.9,.9),cc.scaleTo(.5,1,1))))}))),!0)}}),cc._RF.pop()},{}],BombEffectItem:[function(t,e){"use strict";cc._RF.push(e,"a6be8ualqNKkaH/idVFnw5y","BombEffectItem"),cc.Class({extends:cc.Component,properties:{},start:function(){},bombFinish:function(){window.GAME_CONTROL&&window.GAME_CONTROL.bombFinish()}}),cc._RF.pop()},{}],Common_CommonUtil:[function(t,e,i){"use strict";cc._RF.push(e,"ebb13d72ThG1bdnQlyELKRv","Common_CommonUtil"),Object.defineProperty(i,"__esModule",{value:!0});var n=function(){function t(){}return t.isWeChat=function(){return cc.sys.platform==cc.sys.WECHAT_GAME},t.showTips=function(t,e){cc.loader.loadRes("common/prefabs/h5game_Tips",function(i,n){if(i)cc.error(i);else{var o=cc.instantiate(n);o.getComponent("h5game_Tips").setText(t,e),o.parent=cc.director.getScene()}})},t.showShareFailTips=function(){t.getPrefab("prefabs/n_sharebubble",function(t){t.parent=cc.find("Canvas")||cc.director.getScene().children[0],t.zIndex=2048})},t.shakeScreen=function(t,e,i){void 0===e&&(e=.02),void 0===i&&(i=10);var n=t;n.stopAllActions(),n.runAction(cc.sequence(cc.moveBy(e,cc.v2(2*i,0)),cc.moveBy(2*e,cc.v2(4*-i)),cc.moveBy(e,cc.v2(2*i)),cc.moveBy(e,cc.v2(0,2*i)),cc.moveBy(2*e,cc.v2(0,4*-i)),cc.moveBy(e,cc.v2(0,2*i)),cc.moveBy(e,cc.v2(i,0)),cc.moveBy(2*e,cc.v2(2*-i,0)),cc.moveBy(e,cc.v2(i,0)),cc.moveBy(e,cc.v2(0,i)),cc.moveBy(2*e,cc.v2(0,2*-i)),cc.moveBy(e,cc.v2(0,i))))},t.fitScreen=function(){var t=cc.director.getScene().getComponentInChildren(cc.Canvas),e=cc.view.getVisibleSize();e.width/e.height<9/16?(t.fitWidth=!0,t.fitHeight=!1):(t.fitWidth=!1,t.fitHeight=!0)},t.resetScale=function(t){var e=cc.view.getVisibleSize();e.width/e.height<9/16?t.scale=e.width/1080:t.scale=e.height/1920},t.imgStr=function(t){return t},t.txtStr=function(t){return t},t.getLaunchParams=function(){if(cc.sys.isNative)return null;if(t.isWeChat()){var e=wx.getLaunchOptionsSync().query;return e.token&&e.userId&&e.gameId&&e.serverHost?e:null}var i=window.location.href,n=null,o=i.lastIndexOf("?");return o>=0&&(n=i.substring(o)),function(){if(!n)return null;for(var t={},e=n.substr(1).split("&"),i=0;i<e.length;i++){var o=e[i].split("=");t[o[0]]=o[1]}return t.token&&t.userId&&t.gameId&&t.serverHost?t:null}()},t.preview=function(){t.isWeChat()&&wx.previewImage({urls:["https://h5gameres.kuaiyugo.com/chatgame/cocos_games_res/images/codeImage.jpg"]})},t.setSprite=function(t,e,i){if(void 0===e&&(e=""),void 0===i&&(i=null),!t)throw new Error("\u8bf7\u4f20\u5165\u6b63\u786e\u7684\u8282\u70b9\u540d\u79f0");if(!e)throw new Error("\u8bf7\u4f20\u5165\u6b63\u786e\u7684\u8d44\u6e90\u8def\u5f84");var n;if(t instanceof cc.Sprite)n=t;else if(t instanceof cc.Node)n=t.getComponent(cc.Sprite);else{if("[object String]"!==Object.prototype.toString.call(t))throw new Error("\u4f20\u5165\u8282\u70b9\u8d44\u6e90\u7c7b\u578b\u4e0d\u6b63\u786e");n=cc.find(t).getComponent(cc.Sprite)}if(!n)throw new Error("\u672a\u627e\u5230\u6b63\u786e\u7684Sprite");if(n&&n.spriteFrame){var o=n.node.opacity;n.node.opacity=0;var c="load";0!=e.indexOf("http")&&(c+="Res"),cc.loader[c](e,function(t,e){t?cc.error(t.message||t):(n.spriteFrame=new cc.SpriteFrame(e),n.node.opacity=o,i&&i())})}},t.getPrefab=function(t,e){cc.loader.loadRes(t,function(t,i){if(t)throw t;e(cc.instantiate(i))})},t.setAvatarSprite=function(t,e){var i=null;if(t instanceof cc.Sprite?i=t:t instanceof cc.Node&&(i=t.getComponent(cc.Sprite)),!i)throw new Error("CommonUtil.setSprite:  \u65e0\u6cd5\u627e\u5230\u6b63\u786e\u7684Sprite");var n=wx.createImage();n.onload=function(){var t=new cc.Texture2D;t.initWithElement(n),t.handleLoadedTexture(),i.spriteFrame=new cc.SpriteFrame(t)},n.src=e},t}();i.default=n,cc._RF.pop()},{}],Data:[function(t,e){"use strict";cc._RF.push(e,"b846fNhcCFFZrE+CJj/eqje","Data"),e.exports={onShow:function(){},onHide:function(){},share:function(){},shareScore:function(){},setData:function(){},getData:function(){},getGameConfigByAppkey:function(){}},cc._RF.pop()},{}],EffectCommon:[function(t,e){"use strict";cc._RF.push(e,"0e4batwDktDsKv2pkukBcXZ","EffectCommon");var i=t("ccShader_Default_Vert"),n=t("ccShader_Default_Vert_noMVP"),o=t("ccShader_wave");t("Utils"),cc.Class({extends:cc.Component,properties:{},onLoad:function(){this.parameters={time:0,mouse:{x:.5,y:.5},resolution:{x:0,y:0},wavewidth:6/108},this.node.on(cc.Node.EventType.TOUCH_END,function(t){var e=t.touch.getLocation();e=this.node.convertToNodeSpace(e),this.parameters.mouse.x=e.x/this.node.getContentSize().width,this.parameters.mouse.y=e.y/this.node.getContentSize().height,this.parameters.time=0,this.parameters.wavewidth=40/this.node.getContentSize().width,this.showWave()},this),this._show_wave=!1,this._use()},showWave:function(){this._show_wave=!0},update:function(t){if(this._program&&this._show_wave)if(this._program.use(),this.updateGLParameters(t),cc.sys.isNative){var e=cc.GLProgramState.getOrCreateWithGLProgram(this._program);e.setUniformFloat("time",this.parameters.time),e.setUniformVec2("mouse",this.parameters.mouse)}else this._program.setUniformLocationWith1f(this._time,this.parameters.time),this._program.setUniformLocationWith2f(this._mouse,this.parameters.mouse.x,1-this.parameters.mouse.y)},updateGLParameters:function(t){this.parameters.time+=t},_use:function(){if(this._program=new cc.GLProgram,cc.sys.isNative?(cc.log("use native GLProgram"),this._program.initWithString(n,o),this._program.addAttribute(cc.macro.ATTRIBUTE_NAME_POSITION,cc.macro.VERTEX_ATTRIB_POSITION),this._program.addAttribute(cc.macro.ATTRIBUTE_NAME_COLOR,cc.macro.VERTEX_ATTRIB_COLOR),this._program.addAttribute(cc.macro.ATTRIBUTE_NAME_TEX_COORD,cc.macro.VERTEX_ATTRIB_TEX_COORDS),this._program.link(),this._program.updateUniforms()):(this._program.initWithVertexShaderByteArray(i,o),this._program.addAttribute(cc.macro.ATTRIBUTE_NAME_POSITION,cc.macro.VERTEX_ATTRIB_POSITION),this._program.addAttribute(cc.macro.ATTRIBUTE_NAME_COLOR,cc.macro.VERTEX_ATTRIB_COLOR),this._program.addAttribute(cc.macro.ATTRIBUTE_NAME_TEX_COORD,cc.macro.VERTEX_ATTRIB_TEX_COORDS),this._program.link(),this._program.updateUniforms()),cc.sys.isNative){var t=cc.GLProgramState.getOrCreateWithGLProgram(this._program);t.setUniformFloat("time",this.parameters.time),t.setUniformVec2("mouse",this.parameters.mouse)}else this._time=this._program.getUniformLocationForName("time"),this._mouse=this._program.getUniformLocationForName("mouse"),this._program.setUniformLocationWith1f(this._time,this.parameters.time),this._program.setUniformLocationWith2f(this._mouse,this.parameters.mouse.x,this.parameters.mouse.y);this.setProgram(this.node._sgNode,this._program)},setProgram:function(t,e){if(cc.sys.isNative){var i=cc.GLProgramState.getOrCreateWithGLProgram(e);t.setGLProgramState(i)}else t.setShaderProgram(e);var n=t.children;if(n)for(var o=0;o<n.length;o++)this.setProgram(n[o],e)}}),cc._RF.pop()},{Utils:"Utils",ccShader_Default_Vert:"ccShader_Default_Vert",ccShader_Default_Vert_noMVP:"ccShader_Default_Vert_noMVP",ccShader_wave:"ccShader_wave"}],GameEndRank:[function(t,e){"use strict";cc._RF.push(e,"167feF+j91EO55DYgd2LPJO","GameEndRank"),t("RankList"),cc.Class({extends:cc.Component,properties:{display:cc.Sprite},start:function(){this.tex=new cc.Texture2D},_updaetSubDomainCanvas:function(){this.tex&&(this.tex.initWithElement(sharedCanvas),this.tex.handleLoadedTexture(),this.display.spriteFrame=new cc.SpriteFrame(this.tex))},update:function(){"undefined"!=typeof wx&&this._updaetSubDomainCanvas()}}),cc._RF.pop()},{RankList:"RankList"}],GameLoad:[function(t,e){"use strict";cc._RF.push(e,"c64f73DiYxHd7e8a+8ulTfg","GameLoad"),t("./common/Wxlife");var i=t("ShareSdk"),n=t("Utils");cc.Class({extends:cc.Component,properties:{m_n_logo:cc.Node,m_loaded:!1,m_l_text:cc.Label},start:function(){n.setDesignResolution(),this.m_n_logo.opacity=0,this.m_loaded=!1,this.m_loaded2=!1;var t=this;this._loadnum=0,"undefined"!=typeof wx&&wx.cloud.init({env:window.ENV,traceUser:!0,success:function(){}}),this.m_n_logo.runAction(cc.sequence(cc.fadeIn(.2),cc.callFunc(function(){t.loadres(),t.loadconfig()})));var e=cc.sys.localStorage.getItem("music"),o=cc.sys.localStorage.getItem("guideinfo"),c=cc.sys.localStorage.getItem("change");console.log("guideboo",o),e&&"null"!=e?window.MUSIC_SHOW_OFF=parseInt(e):(window.MUSIC_SHOW_OFF=1,cc.sys.localStorage.setItem("music",""+window.MUSIC_SHOW_OFF)),window.GUIDE_LEVEL=o&&"null"!=o?1:0,window.CHANGE_BLOCK=c&&"null"!=c?1:0,i.setShareMenuEnabled(!0,!0)},loadconfig:function(){this._loadnum++,this.enterGame()},loadres:function(){console.log("load res");var t=this;window.tempFileURL=[];for(var e=1;e<4;e++)window.tempFileURL.push("");"undefined"!=typeof wx?(wx.showLoading({title:"\u767b\u5f55\u4e2d..."}),cc.loader.loadRes("level_config2",function(e,i){e?cc.error(e.message||e):(window.MAP_CONFIG=i.json,t._loadnum++,t.enterGame())}),wx.cloud.callFunction({name:"login",success:function(e){console.log(e.result.event.userInfo),window.userInfo=e.result.event.userInfo,n.getSaveData(function(){window.getdata=!0,t._loadnum++,t.enterGame()})},fail:function(t){console.error(t),wx.showModal({title:"\u63d0\u793a",content:"\u767b\u5f55\u5f02\u5e38\uff0c\u8bf7\u7a0d\u540e\u91cd\u8bd5:"+t.Msg,showCancel:!1,success:function(){wx.exitMiniProgram()}})}})):(t._loadnum=1,cc.loader.loadRes("level_config2",function(e,i){e?cc.error(e.message||e):(window.MAP_CONFIG=i.json,t._loadnum++,t.enterGame())})),this.MyPreloadScene(window.GAME_SCENE_NAME,function(e,i){t.m_l_text.string="\u6e38\u620f\u52a0\u8f7d\u4e2d..."+Math.floor(e/i*100)+"%"},function(){console.log("preloadScene finish"),t._loadnum++,t.enterGame()})},MyPreloadScene:function(t,e,i){void 0===i&&(i=e,e=null);var n=cc.director._getSceneUuid(t);if(n)cc.director.emit(cc.Director.EVENT_BEFORE_SCENE_LOADING,t),cc.loader.load({uuid:n.uuid,type:"uuid"},e,function(e,n){e&&cc.errorID(1210,t,e.message),i&&i(e,n)});else{var o='Can not preload the scene "'+t+'" because it is not in the build settings.';i(new Error(o)),cc.error("preloadScene: "+o)}},enterGame:function(){this._loadnum>=4&&("undefined"!=typeof wx&&wx.hideLoading(),cc.director.loadScene(window.GAME_SCENE_NAME))}}),cc._RF.pop()},{"./common/Wxlife":"Wxlife",ShareSdk:"ShareSdk",Utils:"Utils"}],GameMain:[function(t,e){"use strict";cc._RF.push(e,"e108aAONHJBsKqEpmBpBRLe","GameMain");var i=t("Utils"),n=t("ShareSdk"),o=t("RankList");cc.Class({extends:cc.Component,properties:{m_n_gamenode:cc.Node,m_n_bg_panel:cc.Node,m_pre_blockbg:cc.Prefab,m_pre_light:cc.Prefab,m_pre_boomeffect:cc.Prefab,m_pre_boom:cc.Prefab,m_l_boomnum:cc.Label,m_l_score:cc.Label,m_sp_monster:sp.Skeleton,m_l_level:cc.Label,m_n_result_panel:cc.Node,m_btn_tool2:cc.Node,m_n_guidemask:cc.Node,m_n_tooluse:cc.Node,m_n_showtime:{type:cc.Node,default:[]},m_spf_gold:cc.SpriteFrame,m_n_askpanel:cc.Node,m_n_boss:cc.Node,m_spriteAtlas:cc.SpriteAtlas,m_n_bglist:cc.Node,m_l_gold:cc.Label,m_pre_rock:cc.Prefab,m_n_kuai:{type:cc.Node,default:[]},m_n_displaycheck:cc.Node,m_n_displayrank:cc.Node,m_n_stepview:cc.Node,m_n_reliveview:cc.Node,m_n_video:cc.Node,m_n_lookvideo:cc.Node,m_n_luckyvideo:cc.Node,m_n_doublevideo:cc.Node,m_n_doublescore:cc.Node,m_n_sharegift:cc.Node,m_n_skinpanel:cc.Node,m_n_guidenode:cc.Node,m_l_asktype:cc.Label,m_n_guidefiger:cc.Node,node_guoguan:cc.Node},onLoad:function(){window.GAME_CONTROL=this,i.setDesignResolution()},onDestroy:function(){this.m_block_pool.clear(),this.m_light_pool.clear(),window.GAME_CONTROL=null,this.m_bannerad&&(this.m_bannerad.destroy(),this.m_bannerad=null),EVENT_LISTENER.off(window.GAME_UPDATE_DATA,this),EVENT_LISTENER.off(window.GAME_SAVE_HANDLER,this)},start:function(){window.firstGame&&(window.firstGame=!1),this.createMap(),this.initData(),this.initMonster(this.m_cur_level),this.showAdBanner(!1),this.node.on(cc.Node.EventType.TOUCH_END,this.touchEnd,this),EVENT_LISTENER.on(window.GAME_UPDATE_DATA,this.updateGold,this),EVENT_LISTENER.on(window.GAME_SAVE_HANDLER,this.updateSkin,this)},initData:function(){this.m_n_skinpanel.getComponent("SkinPanel").initData(),this.m_n_displaycheck.active=!0,this.m_n_displayrank.active=!1,this.m_n_lookvideo.active=!1,this.m_n_doublescore.active=!1,this.m_gamestate=0,this.m_cur_score=0,this.m_cur_level=1,this.m_normal_talktime=4,this.m_normal_curtime=-1,this.m_target_block=[],this.m_mapblink=!1,this.m_touch_boom=!1,this._relivenum=0,this._videonum=0,this._killnum=0,this.m_l_score.string=this.m_cur_score,this.m_doublescore=1,this.m_l_level.string="LV."+this.m_cur_level,this.m_l_gold.string=window.INIT_GAME_SAVE_DATA.gold_num,this._isdeleting=!1,this._isbless=!1,this.m_block_pool=new cc.NodePool,this.m_light_pool=new cc.NodePool,this.updateToolsNum(),this.schedule(function(){this.m_btn_tool2.runAction(cc.sequence(cc.repeat(cc.sequence(cc.rotateTo(.1,-10),cc.rotateTo(.1,10)),3),cc.rotateTo(.1,0)))},5),this._configlist=this.m_n_kuai[0].getComponent("ShapeItem").getTheConfig(),o.checkWillSurpass(this.m_cur_score),i.random(0,1e3)},hideGuide:function(){1==this.m_cur_level&&(this.m_n_guidenode.active=!1,this.m_n_guidefiger.stopAllActions(),this.m_n_guidefiger.active=!1,window.GUIDE_LEVEL=1,cc.sys.localStorage.setItem("guideinfo","1"))},showGuide:function(){var t=this;if(!this._tempguide){this._tempguide=!0;for(var e=0,i=window.INIT_GAME_SAVE_DATA.skin,n=0;n<i.length;n++)if(i[n]>=2){e=n;break}var o=window.SKIN_CONFIG[e];this.m_n_guidenode.active=!0,this.m_n_guidefiger.active=!0,this.m_n_guidefiger.position=this.m_n_kuai[1].position,this.m_n_guidefiger.runAction(cc.repeatForever(cc.sequence(cc.callFunc(function(){t.m_n_guidefiger.position=t.m_n_kuai[1].position}),cc.moveTo(1,this.m_n_kuai[1].x,this.m_n_kuai[1].y+350))));var c=this.m_n_kuai[0].getComponent("ShapeItem").getCurColorIndex(),s=[];s[46]=1,s[52]=1,s[53]=1,s[58]=1;for(var a=43;a<61;a++)if(s[a]);else{var r=new cc.Node("colorSpr");r.colorIndex=c,r.colorName=o.name;var _=r.addComponent(cc.Sprite);console.log(o.name,c),_.spriteFrame=this.m_spriteAtlas.getSpriteFrame(o.name+c),r.position=cc.Vec2.ZERO,r.parent=this.m_maparray[a],this.m_maparray[a].isHaveFK=!0}}},onKeepGoing:function(){this.m_n_luckyvideo.active=!1,this.showAdBanner(!1)},touchEnd:function(t){if(0==this.m_gamestate&&this.m_touch_boom){this.m_gamestate=2;var e=t.touch.getLocation();e=this.m_n_gamenode.convertToNodeSpace(e);var i=this.backIndexofList(e);i>=0&&(this.m_maparray[i].isHaveFK||(this.m_maparray[i].isHaveFK=!0,cc.instantiate(this.m_pre_boom).parent=this.m_maparray[i],window.INIT_GAME_SAVE_DATA.tool[0]-=1,this.updateToolsNum(),this.doBoomAction(this.m_maparray[i].position,i))),this.m_n_guidemask.active=!this.m_mapblink,this.m_touch_boom=!this.m_mapblink,this.setMapBlink(!this.m_mapblink),this.m_gamestate=0;for(var n=0;n<this.m_n_kuai.length;n++)this.m_n_kuai[n].getComponent("ShapeItem").checkIsLose()?this.m_n_kuai[n].opacity=125:this.m_n_kuai[n].opacity=255}},doBoomAction:function(t,e){var n=this;this.m_maparray[e].getChildByName("colorSpr").runAction(cc.sequence(cc.spawn(cc.scaleTo(.5,2),cc.fadeOut(.5)),cc.removeSelf(!0))),this.m_maparray[e].isHaveFK=null,this.scheduleOnce(function(){var e=cc.instantiate(n.m_pre_boomeffect);e.parent=n.m_n_gamenode,e.position=t,e.y-=100,e.zIndex=256,e.getComponent(cc.Animation).play("bombeffect"),i.SetSoundEffect(window.BOOM_EFFECT,!1,1)},.4);var o=this.getBoomIndexList(e);console.log(o);var c=0,s=[];s.push(cc.delayTime(.4));for(var a=0;a<o.length;a++){for(var r=o[a],_=0;_<r.length;_++){var h=r[_];this.m_maparray[h].isHaveFK&&(s.push(cc.callFunc(function(){var t=arguments[1][0],e=arguments[1][1],n=this.getAddScoreCal(e);i.showHurtText("+"+n,this.m_n_gamenode,this.m_maparray[t].x,this.m_maparray[t].y,20,null,null,null,!0),this.updateScore(n)},this,[h,c])),s.push(cc.callFunc(function(){var t=arguments[1];this.m_maparray[t].isHaveFK=null;var e=this.m_maparray[t].getChildByName("colorSpr");e&&(this.attackMonster(e.colorIndex,this.m_maparray[t].x,this.m_maparray[t].y),e.runAction(cc.sequence(cc.spawn(cc.scaleTo(.5,2),cc.fadeOut(.5)),cc.removeSelf(!0))))},this,h)),c++)}s.push(cc.delayTime(.3))}if(s.length>0){s.push(cc.callFunc(function(){this._isdeleting=!1,this.checkIsLose()},this)),this._isdeleting=!0;var l=cc.sequence(s);this.node.runAction(l)}},getBoomIndexList:function(t){return window.boomrange[t]},bombFinish:function(){},getCanDropBlocks:function(){for(var t=[0,0,0],e=this._configlist.length-1;e>=1;e--)for(var n=0;n<this.m_maparray.length;n++){var o=this.m_maparray[n],c=cc.v2(o.x,o.y),s=1;if(!o.isHaveFK){for(var a=this._configlist[e],r=1;r<a.length;r++)for(var _=c.add(cc.v2(a[r].x,a[r].y)),h=0;h<this.m_maparray.length;h++){var l=this.m_maparray[h];cc.v2(l.x,l.y).sub(_).mag()<=52&&!l.isHaveFK&&s++}if(s==a.length){t.push(e);break}}}if(t.length>3){var m=i.getRandomSDiff(0,t.length-1,3);return[t[m[0]],t[m[1]],t[m[2]]]}return[t[0],t[1],t[2]]},backIndexofList:function(t){for(var e=0;e<window.INDEX_TO_POINT.length;e++)if(t.sub(cc.v2(window.INDEX_TO_POINT[e][0],window.INDEX_TO_POINT[e][1])).mag()<=50)return e;return-1},updateToolsNum:function(){this.m_boomnum=window.INIT_GAME_SAVE_DATA.tool[0],this.m_l_boomnum.string="x"+this.m_boomnum,this.setAddVisible(this.m_btn_tool2,this.m_boomnum),this.updateGold()},updateGold:function(){this.m_l_gold.string=window.INIT_GAME_SAVE_DATA.gold_num},updateSkin:function(){console.log("updateskin");for(var t=0,e=0;e<this.m_n_kuai.length;e++)t=this.m_n_kuai[e].getComponent("ShapeItem").updateIndex(!0);for(var i=window.SKIN_CONFIG[t],n=0;n<this.m_maparray.length;n++){var o=this.m_maparray[n].getChildByName("colorSpr");o&&(o.getComponent(cc.Sprite).spriteFrame=this.m_spriteAtlas.getSpriteFrame(i.name+o.colorIndex))}},setAddVisible:function(t,e){this.m_l_boomnum.node.active=e>0},updateScore:function(t){this.m_cur_score+=t,this.m_l_score.string=this.m_cur_score,this.m_n_result_panel.active||o.checkWillSurpass(this.m_cur_score),this.m_cur_score>window.INIT_GAME_SAVE_DATA.top_score&&(window.INIT_GAME_SAVE_DATA.top_score=this.m_cur_score,o.setScore(window.INIT_GAME_SAVE_DATA.top_score))},createMap:function(){this.m_maparray=[];for(var t=[],e=0;e<window.INDEX_TO_POINT.length;e++){var i=cc.instantiate(this.m_pre_blockbg);i.x=window.INDEX_TO_POINT[e][0],i.y=window.INDEX_TO_POINT[e][1],i.parent=this.m_n_bglist,i.FKIndex=e,t.push(i)}this.m_maparray=t},initMonster:function(t){var e=t%100;e<=0&&(e+=1);var i=window.MAP_CONFIG[e-1];cc.log("initMonster:"+t),this.m_sp_monster.node.getComponent("MonsterItem").initType(i.mon_id,i.mon_hp,t,this.m_cur_level),this.m_sp_monster.node.active=!0,this.m_sp_monster.node.opacity=255,this.m_sp_monster.node.y=300;var n=0;this.m_sp_monster.node.getComponent("MonsterItem").playStartTalk(),0==i.mon_id&&(n=-10),this.m_sp_monster.node.runAction(cc.moveTo(.4,0,n).easing(cc.easeIn(3))),this.m_n_boss.active=!0,this.m_n_boss.opacity=50,this.m_n_boss.scale=2.5,this.m_n_boss.runAction(cc.sequence(cc.spawn(cc.scaleTo(.8,1).easing(cc.easeBackIn(3)),cc.fadeTo(.8,255)),cc.moveBy(.02,cc.v2(20,0)),cc.moveBy(.04,cc.v2(-40)),cc.moveBy(.02,cc.v2(20)),cc.moveBy(.02,cc.v2(0,20)),cc.moveBy(.04,cc.v2(0,-40)),cc.moveBy(.02,cc.v2(0,20)),cc.moveBy(.02,cc.v2(10,0)),cc.moveBy(.04,cc.v2(-20,0)),cc.moveBy(.02,cc.v2(10,0)),cc.moveBy(.02,cc.v2(0,10)),cc.moveBy(.04,cc.v2(0,-20)),cc.moveBy(.02,cc.v2(0,10)),cc.fadeOut(1.5)))},addScore:function(t,e){var n=this.getAddScoreCal(t,e);i.showHurtText("+"+n,null,0,0,30),this.updateScore(n)},getAddScoreCal:function(t,e){var i=t+1;return(e?i:i*i)*this.m_doublescore},checkIsLose:function(){if(!this._isdeleting){this.m_normal_curtime=0;for(var t=0,e=0;e<3;e++){var i=cc.find("n_kuai"+(e+1),this.m_n_gamenode);i.getComponent("ShapeItem").checkIsLose()?(t++,i.opacity=125):i.opacity=255}if(t>=2&&!this._isbless){this._isbless=!0;for(var n=0;n<3;n++)cc.find("n_kuai"+(n+1),this.m_n_gamenode).getComponent("ShapeItem").setNextBlock(0)}3==t&&this.judgeGame(!1)}},checkClearUp:function(){for(var t=[],e=0;e<this.m_maparray.length;e++)this.m_maparray[e].isHaveFK&&t.push(this.m_maparray[e].FKIndex);t.sort(function(t,e){return t-e});for(var n=[],o=0;o<window.DISLIST.length;o++){var c=window.DISLIST[o],s=this.get2AryIntersect(t,c);s.length>0&&this.check2AryIsEqual(c,s)&&n.push(c)}for(var a=[],r=0,_=0,h=0;h<n.length;h++){var l=n[h];_+=l.length;for(var m=0;m<l.length;m++){var d=l[m];a.push(cc.callFunc(function(){var t=arguments[1][0],e=arguments[1][1],n=this.getAddScoreCal(e);i.showHurtText("+"+n,this.m_n_gamenode,this.m_maparray[t].x,this.m_maparray[t].y,20,null,null,null,!0),this.updateScore(n)},this,[d,r])),a.push(cc.callFunc(function(){var t=arguments[1];this.m_maparray[t].isHaveFK=null;var e=this.m_maparray[t].getChildByName("colorSpr");e&&(this.attackMonster(e.colorIndex,this.m_maparray[t].x,this.m_maparray[t].y),e.runAction(cc.sequence(cc.spawn(cc.scaleTo(.5,2),cc.fadeOut(.5)),cc.removeSelf(!0))))},this,d)),a.push(cc.delayTime(.1)),r++}}if(a.length>0){i.SetSoundEffect(window.GET_GOLD,!1,1),a.push(cc.callFunc(function(){this._isdeleting=!1,this.checkIsLose()},this)),this.handlerShowTime(_),this._isdeleting=!0;var u=cc.sequence(a);this.node.runAction(u)}},get2AryIntersect:function(t,e){for(var i=[],n=0;n<t.length;n++)for(var o=0;o<e.length;o++)e[o]==t[n]&&i.push(e[o]);return i},check2AryIsEqual:function(t,e){for(var i=0;i<t.length;i++)if(e[i]!=t[i])return!1;return!0},handlerShowTime:function(t){var e=this;cc.log("handlerShowTime",t);var n=-1;t>9&&t<=12?n=0:t>12&&t<=15?n=1:t>15&&(n=2),n>=0&&(2==n?i.SetSoundEffect(window.SAY_3,!1,1):i.SetSoundEffect(window.GET_GOLD,!1,1),this.m_n_showtime[n].active=!0,this.m_n_showtime[n].getComponent(cc.Animation).play(),setTimeout(function(){e.m_n_showtime[n].active=!1},1500))},addGold:function(t,e,n){var o=this,c=this.m_spf_gold;window.INIT_GAME_SAVE_DATA.gold_num+=t;for(var s=0;s<t;s++)i.moveIcon(c,this.m_n_gamenode,e,n,function(){i.SetSoundEffect(window.GET_GOLD,!1,.4),o.m_l_gold.string=window.INIT_GAME_SAVE_DATA.gold_num},.5,60*(s+1))},showBox:function(t,e,n){var o=this,c=function(){n%10==0&&n<=370&&(o.m_n_stepview.scale=0,o.m_n_stepview.active=!0,o.m_n_stepview.runAction(cc.sequence(cc.scaleTo(.2,1.2,1.2).easing(cc.easeIn(3)),cc.scaleTo(.1,1,1))),o.m_n_stepview.getComponent("StepViewItem").showStep(n))};i.loadRes("sprite/getshare_box",cc.SpriteFrame,function(n){i.moveIcon(n,o.m_n_gamenode,t,e,function(){o.m_n_sharegift.active=!0,o.m_n_sharegift.getComponent("GetBoxGiftItem").showView(c)},.8,100)})},attackMonster:function(t,e,n){var o=this,c=t?2*t:2,s=this.m_block_pool.get();s||(s=cc.instantiate(this.m_pre_rock));var a=i.getAngle(this.m_sp_monster.node.parent.x,this.m_sp_monster.node.parent.y,e,n);this.m_sp_monster.node.parent.x<=e&&(a=-a),s.rotation=a,s.getComponent("RockItem").resetSytem(),s.zIndex=32,s.parent=this.m_n_gamenode,s.x=e,s.y=n,s.runAction(cc.sequence(cc.callFunc(function(){}),cc.moveTo(1,cc.v2(this.m_sp_monster.node.parent.x,this.m_sp_monster.node.parent.y)).easing(cc.easeIn(2)),cc.callFunc(function(){o.m_block_pool.put(s),s=null,o.monsterbeHit(c)})))},destroyBlockByHitMonster:function(){for(var t=this,e=this,n=[],o=4,c=0;c<this.m_maparray.length&&!(this.m_maparray[c].isHaveFK&&(n.push(c),--o<=0));c++);for(var s=function(o){var c=t.m_light_pool.get();c||(c=cc.instantiate(t.m_pre_light));var s=t.m_maparray[n[o]].position;c.parent=t.m_n_gamenode,c.position=cc.v2(t.m_sp_monster.node.parent.x,t.m_sp_monster.node.parent.y),c.runAction(cc.sequence(cc.callFunc(function(){i.SetSoundEffect(window.GET_GOLD,!1,1)}),cc.moveTo(.8,s).easing(cc.easeIn(2)),cc.callFunc(function(){e.m_light_pool.put(c),c=null,e.blockBeHit(n[o])})))},a=0;a<n.length;a++)s(a)},blockBeHit:function(t){this.m_maparray[t].isHaveFK=null;for(var e=0;e<this.m_n_kuai.length;e++)this.m_n_kuai[e].getComponent("ShapeItem").checkIsLose()?this.m_n_kuai[e].opacity=125:this.m_n_kuai[e].opacity=255;var i=this.m_maparray[t].getChildByName("colorSpr");i&&i.runAction(cc.sequence(cc.spawn(cc.scaleTo(.5,2),cc.fadeOut(.5)),cc.removeSelf(!0)))},monsterbeHit:function(t){i.SetSoundEffect(window.BE_HIT,!1,.3),i.showHurtText("-"+t,this.m_sp_monster.node.parent,0,100,30,new cc.Color(230,71,21),.8),this.updateScore(t);var e=this.m_sp_monster.node.getComponent("MonsterItem").reduceHp(t);e<=0?(this.m_normal_curtime=-1,this.judgeGame(!0)):(this.m_normal_curtime=0,this.m_solidernum<=0&&this.m_cur_attack_num<=0?this.judgeGame(!1):this.m_cur_attack_num<=0&&e<=20?this.m_sp_monster.node.getComponent("MonsterItem").playAngry():this.m_sp_monster.node.getComponent("MonsterItem").playBeHit())},onOpenSkinPanel:function(){this.m_n_skinpanel.active=!0},onCancelVideo:function(){var t=this;if(this.m_n_lookvideo.active=!1,this._relivenum<=0)if(this.m_n_reliveview.active=!0,this.m_n_reliveview.scale=0,this.m_n_reliveview.runAction(cc.sequence(cc.scaleTo(.2,1.2,1.2).easing(cc.easeIn(3)),cc.scaleTo(.1,1,1))),window.SKIN_SHARE){this.showAdBanner(!1);var e=cc.find("btn_close",this.m_n_reliveview);e.y=-585,this.scheduleOnce(function(){e.y=-514,t.showAdb||t.showAdBanner(!0)},1.3)}else this.showAdBanner(!0);else this.m_n_displaycheck.active=!1,this.m_n_displayrank.active=!0,console.log("this._relivenum++",this._relivenum),this.m_n_result_panel.getComponent("GameResult").showFail(this._relivenum,this.m_cur_score,this._killnum),this.showAdBanner(!0),o.setScore(window.INIT_GAME_SAVE_DATA.top_score),i.SetSoundEffect(window.CHALLENG_FAIL_MUSIC,!1,1);this._relivenum++},onAdBtnClick:function(t,e){if("undefined"!=typeof wx){if(!window.firstvideo&&3==e)return window.firstvideo=!0,void this.videoReward(1);wx.getSystemInfoSync().SDKVersion>="2.0.4"?this.showAd(e):(wx.showToast({title:"\u5fae\u4fe1\u7248\u672c\u8fc7\u4f4e\uff0c\u65e0\u6cd5\u770b\u5e7f\u544a",icon:"none",image:"",duration:0}),setTimeout(function(){return wx.hideToast()},2e3))}else console.log("it is not wechat"),this.videoReward(e)},showAd:function(t){var e=this;this.m_videoAd||(this.m_videoAd=wx.createRewardedVideoAd({adUnitId:"adunit-e573e466be94d7f5"})),this.m_videoAd.onError(function(){}),this.m_videoAd.load().then(function(){e.m_videoAd.show(),e.showAdb=!0,e.m_videoAd.onClose(function(i){e.m_videoAd.offClose(),e.showAdb=!1,e.showAdBanner(!1),(i&&i.isEnded||void 0===i)&&e.videoReward(t)})}).catch(function(){return i.showTipsText("\u62c9\u53bb\u89c6\u9891\u5e7f\u544a\u5931\u8d25\uff0c\u8bf7\u7a0d\u5019\u91cd\u8bd5",null,null,null,60,cc.Color.BLACK,1.2)})},videoReward:function(t){if(1==t||3==t){for(var e=this.getCanDropBlocks(),n=0;n<this.m_n_kuai.length;n++){var o=this.m_n_kuai[n].getComponent("ShapeItem");this.m_n_kuai[n].opacity=255,o.resetBlock(e[n]||0)}this.m_in_judge=!1,this.m_n_lookvideo.active=!1}else 2==t&&(this.m_doublescore=2,this.m_n_doublescore.active=!0,i.showTipsText("\u5f97\u5206\u53cc\u500d",null,0,0,60),this.m_n_luckyvideo.active=!1)},judgeGame:function(t){var e=this;if(!this.m_in_judge)if(this.m_in_judge=!0,t){console.log("\u80dc\u5229"),this._killnum++;var n=this.m_sp_monster.node.getComponent("MonsterItem").playDead();i.SetSoundEffect(window.CHALLENG_VICTORY_MUSIC,!1,1),this.m_sp_monster.node.parent.position,this.m_cur_level,window.INIT_GAME_SAVE_DATA.top_level+=1;var c=this;this.scheduleOnce(function(){e.m_cur_level>=3?e.node_guoguan.active=!0:c.onNextLevel()},n/1e3),this.destroyBlockByHitMonster(),o.setScore(window.INIT_GAME_SAVE_DATA.top_score)}else this._videonum<=0?(console.log("\u5931\u8d25"),this.m_sp_monster.node.getComponent("MonsterItem").playMonsterVictory(),cc.log("=================>",this._videonum),this.m_n_lookvideo.active=!0,this.m_n_lookvideo.scale=0,this.m_n_lookvideo.runAction(cc.sequence(cc.scaleTo(.2,1.2,1.2).easing(cc.easeIn(3)),cc.scaleTo(.1,1,1))),window.firstvideo?this.m_l_asktype.string="\u770b\u89c6\u9891\u6362\u4e00\u6279":this.m_l_asktype.string="\u514d\u8d39\u6362\u4e00\u6279",this._videonum++):this.onCancelVideo()},BoxReward:function(t){0==t?this.updateToolsNum():this.updateGold()},onVideoClose:function(){this.m_n_reliveview.active=!1,this.m_n_displaycheck.active=!1,this.m_n_displayrank.active=!0,this.m_n_result_panel.getComponent("GameResult").showFail(this._relivenum,this.m_cur_score,this._killnum),this.showAdBanner(!0),o.setScore(window.INIT_GAME_SAVE_DATA.top_score),i.SetSoundEffect(window.CHALLENG_FAIL_MUSIC,!1,1)},onReliveBtnClick:function(){"undefined"!=typeof wx?wx.getSystemInfoSync().SDKVersion>="2.0.4"?this.showReliveAd():(wx.showToast({title:"\u5fae\u4fe1\u7248\u672c\u8fc7\u4f4e\uff0c\u65e0\u6cd5\u770b\u5e7f\u544a",icon:"none",image:"",duration:0}),setTimeout(function(){return wx.hideToast()},2e3)):(console.log("it is not wechat"),this.onReliveGameVideo())},showReliveAd:function(){var t=this;this.m_videoAd2||(this.m_videoAd2=wx.createRewardedVideoAd({adUnitId:"adunit-5187ffc3ab571318"})),this.m_videoAd2.onError(function(){}),this.m_videoAd2.load().then(function(){t.m_videoAd2.show(),t.showAdBanner(!1),t.m_videoAd2.onClose(function(e){t.m_videoAd2.offClose(),(e&&e.isEnded||void 0===e)&&t.onReliveGameVideo()})}).catch(function(){return i.showTipsText("\u89c6\u9891\u62c9\u53d6\u5931\u8d25\uff0c\u8bf7\u7a0d\u540e\u91cd\u8bd5",null,null,null,60,cc.Color.BLACK,1.2)})},onNextLevel:function(){this.m_n_result_panel.active=!1,this.showAdBanner(!1),this.m_cur_level++,cc.log("this.m_cur",this.m_cur_level),this.m_in_judge=!1,this.m_l_level.string="LV."+this.m_cur_level,this.initMonster(this.m_cur_level),this.checkIsLose()},onBackToMenu:function(){i.SetSoundEffect(window.BUTTON_CLICK_MUSIC,!1,1),cc.director.loadScene(window.MENU_SCENE_NAME)},onBoomClick:function(){if(i.SetSoundEffect(window.BUTTON_CLICK_MUSIC,!1,1),0==this.m_gamestate&&!this._isdeleting){if(this.m_boomnum<=0)return;this.m_n_guidemask.active=!this.m_mapblink,this.m_touch_boom=!this.m_mapblink,this.setMapBlink(!this.m_mapblink)}},onReGame:function(){cc.director.loadScene("GameLoad")},tuichu:function(){window.opener=null,window.close()},onStrongClick:function(){i.SetSoundEffect(window.BUTTON_CLICK_MUSIC,!1,1),0==this.m_gamestate&&(this.m_n_tooluse.active=!0,this.m_n_tooluse.getComponent("UseToolItem").initToolInfo(1,this.m_strongnum,this.m_spriteAtlas.getSpriteFrame(window.TOOL_CONFIG[1].name)),this.guideMaskClick())},onUseStrong:function(){for(var t=!1,e=0;e<this.m_row;e++)for(var i=0;i<this.m_col;i++)1==this.m_grid_array[e][i].type&&this.m_grid_array[e][i].obj.getComponent("BlockItem").addStrong()&&(t=!0);t&&(window.INIT_GAME_SAVE_DATA.tool[1]-=1,this.updateToolsNum())},setMapBlink:function(t){if(t!==this.m_mapblink)if(this.m_mapblink=t,t){for(var e=0;e<this.m_maparray.length;e++)if(!this.m_maparray[e].isHaveFK){var i=cc.repeatForever(cc.sequence(cc.scaleTo(.8,.8,.8),cc.scaleTo(.8,1,1)));i.setTag(1),this.m_maparray[e].runAction(i)}}else for(var n=0;n<this.m_maparray.length;n++)this.m_maparray[n].isHaveFK||(this.m_maparray[n].stopActionByTag(1),this.m_maparray[n].scale=1)},getTargetGridInfo:function(t){var e=Math.floor(t/this.m_row),i=t%this.m_col;return this.m_maparray[e][i]},onReliveGameVideo:function(){i.showTipsText("\u590d\u6d3b\u6210\u529f"),this.m_in_judge=!1;for(var t=0;t<this.m_n_kuai.length;t++)this.m_n_kuai[t].getComponent("ShapeItem").resetBlock(),this.m_n_kuai[t].opacity=255;this.m_sp_monster.node.getComponent("MonsterItem").playAngry(),this.m_n_result_panel.active=!1,this.m_n_reliveview.active=!1,this.m_maparray.forEach(function(t){t.getChildByName("colorSpr")});for(var e=0;e<this.m_maparray.length;e++){var n=this.m_maparray[e].getChildByName("colorSpr");n&&n.runAction(cc.sequence(cc.spawn(cc.scaleTo(.5,2),cc.fadeOut(.5)),cc.removeSelf(!0))),this.m_maparray[e].isHaveFK=null}o.checkWillSurpass(this.m_cur_score),this.m_n_displaycheck.active=!0,this.m_n_displayrank.active=!1,this.m_gamestate=0},onReliveGame:function(){if(i.SetSoundEffect(window.BUTTON_CLICK_MUSIC,!1,1),window.INIT_GAME_SAVE_DATA.gold_num>=20){i.showTipsText("\u590d\u6d3b\u6210\u529f"),this.m_in_judge=!1,window.INIT_GAME_SAVE_DATA.gold_num-=20,this.updateGold();for(var t=0;t<this.m_n_kuai.length;t++)this.m_n_kuai[t].getComponent("ShapeItem").resetBlock(0),this.m_n_kuai[t].opacity=255;this.m_sp_monster.node.getComponent("MonsterItem").playAngry(),this.m_n_result_panel.active=!1,o.checkWillSurpass(this.m_cur_score),this.m_n_displaycheck.active=!0,this.m_n_displayrank.active=!1,this.m_gamestate=0}else n.shareAppMessage({title:"\u6765\u5e2e\u5e2e\u6211\uff0c\u6211\u88ab\u602a\u517d\u6d88\u706d\u4e86",imageUrl:window.tempFileURL[1],success:function(){},fail:function(){},complate:function(){}})},showAdBanner:function(t){if("undefined"!=typeof wx){var e=cc.winSize,i=cc.find("Canvas/n_funnymap/n_bannerpos"),n=this.node.convertToWorldSpace(i);e.height/e.width>2&&(n.y+=(e.height-1920)/2);var o=wx.getSystemInfoSync(),c=o.screenHeight/e.height,s=(e.height-n.y)*c,a=this;this.m_bannerad&&(this.m_bannerad.destroy(),this.m_bannerad=null),!this.m_bannerad&&t&&(o.SDKVersion<"2.0.4"?(wx.showToast({title:"\u5fae\u4fe1\u7248\u672c\u8fc7\u4f4e\uff0c\u65e0\u6cd5\u521b\u5efa\u5e7f\u544abanner",icon:"none",image:"",duration:0}),setTimeout(function(){return wx.hideToast()},3e3)):(a.m_bannerad=wx.createBannerAd({adUnitId:"adunit-9dd057b6b514245a",style:{left:0,top:s,width:o.screenWidth}}),a.m_bannerad.onResize(function(t){try{a.m_bannerad&&a.m_bannerad.style&&(a.m_bannerad.style.top=s,a.m_bannerad.style.height=t.height)}catch(e){console.log("onResize-error",e)}}),a.m_bannerad.onLoad(function(){}),a.m_bannerad.show().then(function(){}).catch(function(){}),a.m_bannerad.onError(function(){})))}},onOpenAskPanel:function(){this.m_n_askpanel.active=!0},onCloseAskPanel:function(){this.m_n_askpanel.active=!1},update:function(t){-1!=this.m_normal_curtime&&(this.m_normal_curtime+=t,this.m_normal_curtime>=this.m_normal_talktime&&0==this.m_gamestate&&(this.m_normal_curtime=0,this.m_sp_monster.node.getComponent("MonsterItem").playNormal()))}}),cc._RF.pop()},{RankList:"RankList",ShareSdk:"ShareSdk",Utils:"Utils"}],GameMenu:[function(t,e){"use strict";cc._RF.push(e,"5cb45NS+yZNLbHP815RF0Ab","GameMenu");var i=t("Utils"),n=t("ShareSdk"),o=t("RankList");cc.Class({extends:cc.Component,properties:{m_sp_logo:cc.Node,m_l_maingold:cc.Label,m_sp_off:cc.Node,m_spa_list:cc.SpriteAtlas,m_sp_mystepicon:cc.Sprite,m_l_mystepname:cc.Label,m_n_starlist:{type:cc.Node,default:[]},m_n_skinpanel:cc.Node,m_n_moregame:cc.Node},onLoad:function(){window.GAME_MENU=this,i.setDesignResolution()},start:function(){var t=this;EVENT_LISTENER.on(window.GAME_UPDATE_DATA,this.updateGold,this),this.m_l_maingold.string=window.INIT_GAME_SAVE_DATA.gold_num,this.showGameClubButton(),this.updateMusicBtnSprite(window.MUSIC_SHOW_OFF),o.setScore(window.INIT_GAME_SAVE_DATA.top_score),"undefined"!=typeof wx&&(wx.showShareMenu({withShareTicket:!0}),wx.onShareAppMessage(function(){return{title:"\u597d\u73a9\u53c8\u65b0\u5947\uff0c\u6d88\u78e8\u65f6\u95f4\u597d\u5e2e\u624b",imageUrl:window.tempFileURL[1]}})),this.showAdBanner(!0),!window.SHOWNEWYEAR&&window.NEWYEAR?i.loadRes("prefabs/happynewyear",cc.Prefab,function(e){var i=cc.instantiate(e);i.zIndex=1024,i.parent=t.node,window.SHOWNEWYEAR=!0}):i.playBgmMusic(window.BGM,.5),this.initMyData(),this.m_n_moregame.active=window.MOVEGAME},playmuisc:function(){i.playBgmMusic(window.BGM,.5)},initMyData:function(){var t=window.INIT_GAME_SAVE_DATA.top_level,e=this.getMyStepData(t);if(e){this.m_sp_mystepicon.spriteFrame=this.m_spa_list.getSpriteFrame(e.icon_path),this.m_l_mystepname.string=e.desc;for(var i=0;i<this.m_n_starlist.length;i++)this.m_n_starlist[i].active=i<e.star}else{this.m_sp_mystepicon.spriteFrame=this.m_spa_list.getSpriteFrame("stepicon6"),this.m_l_mystepname.string=window.STEP_CONFIG[0].desc;for(var n=0;n<this.m_n_starlist.length;n++)this.m_n_starlist[n].active=n<3}this.m_n_skinpanel.getComponent("SkinPanel").initData()},getMyStepData:function(t){var e=Math.floor(t/10);return e<=0?null:(e>window.STEP_CONFIG.length&&(e=window.STEP_CONFIG.length),window.STEP_CONFIG[e-1])},updateGold:function(){this.m_l_maingold.string=window.INIT_GAME_SAVE_DATA.gold_num},onStartGame:function(){i.SetSoundEffect(window.BUTTON_CLICK_MUSIC,!1,1),cc.director.loadScene(window.GAME_SCENE_NAME)},onCloseShare:function(){cc.director.loadScene(window.GAME_SCENE_NAME)},onShareStart:function(){i.SetSoundEffect(window.BUTTON_CLICK_MUSIC,!1,1),n.shareAppMessage({title:"\u6765\u52a9\u529b\u6211\u4e00\u8d77\u6253\u602a\u517d\u5427",imageUrl:window.tempFileURL[1],success:function(){cc.director.loadScene(window.GAME_SCENE_NAME)},fail:function(){},complate:function(){}})},onOpenSkinPanel:function(){this.m_n_skinpanel.active=!0},onOpenStepRank:function(){i.SetSoundEffect(window.BUTTON_CLICK_MUSIC,!1,1),window.isWeChatPlatform&&wx.showLoading({title:"\u52a0\u8f7d\u4e2d..."}),cc.director.loadScene(window.STEP_SCENE_NAME,function(){window.isWeChatPlatform&&wx.hideLoading()})},onMusicBtnClick:function(){1==window.MUSIC_SHOW_OFF?(window.MUSIC_SHOW_OFF=0,i.stopBgmMusic(),cc.sys.localStorage.setItem("music","0")):(window.MUSIC_SHOW_OFF=1,i.playBgmMusic(window.BGM,.5),cc.sys.localStorage.setItem("music","1")),this.updateMusicBtnSprite(window.MUSIC_SHOW_OFF)},updateMusicBtnSprite:function(t){this.m_sp_off.active=1!=t},onShare:function(){i.SetSoundEffect(window.BUTTON_CLICK_MUSIC,!1,1),n.shareAppMessage({title:"\u4eca\u5e74\u6700\u597d\u73a9\u6700\u523a\u6fc0\u7684\u516d\u8fb9\u5f62\u6d88\u9664\u602a\u517d\u6e38\u620f\uff0c\u5feb\u6765\u5c1d\u8bd5\u4e0b",imageUrl:window.tempFileURL[1],success:function(t){console.log("res",t)},fail:function(){console.log("res-err")},complate:function(){console.log("complate")}})},onMoreGame:function(){"undefined"!=typeof wx&&wx.navigateToMiniProgram?wx.navigateToMiniProgram({appId:"wx7109309214f4c86e",success:function(){console.log("\u8df3\u8f6c\u6210\u529f")},fail:function(t){console.log("\u8df3\u8f6c\u5931\u8d25\uff1a",t)},complete:function(){console.log("\u8df3\u8f6c\u5b8c\u6210")}}):wxShortCut.showModal("\u63d0\u793a","\u6682\u672a\u5f00\u653e")},showGameClubButton:function(){"undefined"!=typeof wx&&(this.clubbutton||(this.clubbutton=wx.createGameClubButton({icon:"light",style:{left:10,top:300,width:40,height:40}})),this.clubbutton.show())},hideGameClubButton:function(){this.clubbutton&&this.clubbutton.hide()},onDestroy:function(){this.clubbutton&&(this.clubbutton.destroy(),this.clubbutton=null),this.m_bannerad&&(this.m_bannerad.destroy(),this.m_bannerad=null),EVENT_LISTENER.off(window.GAME_UPDATE_DATA,this),window.GAME_MENU=null},showAdBanner:function(t){if("undefined"!=typeof wx){var e=cc.winSize,i=cc.find("Canvas/n_funnymap/n_bannerpos"),n=this.node.convertToWorldSpace(i);e.height/e.width>2&&(n.y+=(e.height-1920)/2);var o=wx.getSystemInfoSync(),c=o.screenHeight/e.height,s=(e.height-n.y)*c,a=this;t?this.m_bannerad&&this.m_bannerad.show():this.m_bannerad&&this.m_bannerad.hide(),!this.m_bannerad&&t&&(o.SDKVersion<"2.0.4"?(wx.showToast({title:"\u5fae\u4fe1\u7248\u672c\u8fc7\u4f4e\uff0c\u65e0\u6cd5\u521b\u5efa\u5e7f\u544abanner",icon:"none",image:"",duration:0}),setTimeout(function(){return wx.hideToast()},3e3)):(a.m_bannerad=wx.createBannerAd({adUnitId:"adunit-9dd057b6b514245a",style:{left:0,top:s,width:o.screenWidth}}),a.m_bannerad.onResize(function(t){try{a.m_bannerad&&a.m_bannerad.style&&(a.m_bannerad.style.top=s,a.m_bannerad.style.height=t.height)}catch(e){console.log("onResize-error",e)}}),a.m_bannerad.onLoad(function(){console.log("banner \u5e7f\u544a\u52a0\u8f7d\u6210\u529f")}),a.m_bannerad.show().then(function(){console.log("\u5e7f\u544a\u663e\u793a\u6210\u529f")}).catch(function(t){console.error("\u5e7f\u544a\u52a0\u8f7d\u5931\u8d25",t)}),a.m_bannerad.onError(function(t){console.error(t)})))}}}),cc._RF.pop()},{RankList:"RankList",ShareSdk:"ShareSdk",Utils:"Utils"}],GameResult:[function(t,e){"use strict";cc._RF.push(e,"837bfcDQspAUrwybQW0KLaf","GameResult");var i=t("RankList"),n=t("Utils"),o=t("ShareSdk");cc.Class({extends:cc.Component,properties:{m_n_fail:cc.Node,m_sp_titlef:cc.Node,m_btn_again:cc.Node,m_btn_share:cc.Node},start:function(){},showVictory:function(){},showFail:function(t,e,n){this._score=e,this._monster_num=n,this.node.active=!0,this.m_n_fail.active=!0,this.m_n_fail.y=-cc.winSize.height/2,this.m_n_fail.runAction(cc.sequence(cc.moveTo(.5,0,0).easing(cc.easeIn(3)),cc.callFunc(function(){}))),this.m_sp_titlef.stopAllActions(),this.m_sp_titlef.runAction(cc.repeatForever(cc.sequence(cc.moveBy(.5,0,10),cc.moveBy(.5,0,-10)))),this.m_btn_again.active=!0,this.m_btn_share.active=!0,i.showGameResultList()},onBackToMenu:function(){n.SetSoundEffect(window.BUTTON_CLICK_MUSIC,!1,1),cc.director.loadScene(window.MENU_SCENE_NAME)},onAgainPlay:function(){n.SetSoundEffect(window.BUTTON_CLICK_MUSIC,!1,1),cc.director.loadScene(window.GAME_SCENE_NAME)},onResultShare:function(){o.shareAppMessage({title:"\u5b9d\u5b9d\u8981\u54ed\u6655\u5728\u5c71\u4e0a\u4e86\uff0c\u5feb\u6765\u5e2e\u5e2e\u5b83\uff01",imageUrl:window.tempFileURL[2],success:function(){},fail:function(){},complate:function(){}})}}),cc._RF.pop()},{RankList:"RankList",ShareSdk:"ShareSdk",Utils:"Utils"}],GameStep:[function(t,e,i){"use strict";cc._RF.push(e,"cf803qligpD3LYrN7Q/987O","GameStep"),Object.defineProperty(i,"__esModule",{value:!0});var n=t("./common/Utils"),o=cc._decorator,c=o.ccclass,s=o.property,a=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.m_spa_list=null,e.m_n_bigstepcontent=null,e.m_sp_mystepicon=null,e.m_sp_mystepname=null,e.m_n_mystarlist=[],e.m_pre_bigstep=null,e.m_nodepoll=null,e}return __extends(e,t),e.prototype.start=function(){var t=window.STEP_CONFIG.length;this.m_n_bigstepcontent.height=115*t+20*(t-1);for(var e=0,i=t-1;i>=0;i--){var n=cc.instantiate(this.m_pre_bigstep);n.x=0,n.y=-62-(t-i-1)*(n.height+20),this.m_n_bigstepcontent.addChild(n);var o=window.STEP_CONFIG[i],c=e%4;n.getComponent("BigStepItem").updateData(o,this.m_spa_list.getSpriteFrame(o.icon_path),this.m_spa_list.getSpriteFrame(o.desc_path),window.INIT_GAME_SAVE_DATA.top_level,c),e++}this.m_n_bigstepcontent.parent.parent.getComponent(cc.ScrollView).scrollToOffset(cc.v2(0,this.m_n_bigstepcontent.height)),this.initMyData()},e.prototype.onToggleClick=function(){},e.prototype.initMyData=function(){var t=window.INIT_GAME_SAVE_DATA.top_level,e=this.getMyStepData(t);if(e){this.m_sp_mystepicon.spriteFrame=this.m_spa_list.getSpriteFrame(e.icon_path),this.m_sp_mystepname.spriteFrame=this.m_spa_list.getSpriteFrame(e.desc_path);for(var i=0;i<this.m_n_mystarlist.length;i++)this.m_n_mystarlist[i].active=i<e.star}else for(this.m_sp_mystepicon.spriteFrame=this.m_spa_list.getSpriteFrame("stepicon6"),this.m_sp_mystepname.spriteFrame=this.m_spa_list.getSpriteFrame("stepname6"),i=0;i<this.m_n_mystarlist.length;i++)this.m_n_mystarlist[i].active=i<=0},e.prototype.onBackHome=function(){n.SetSoundEffect(window.BUTTON_CLICK_MUSIC,!1,1),cc.director.loadScene(window.MENU_SCENE_NAME)},e.prototype.getMyStepData=function(t){var e=Math.floor(t/10);return e<=0?null:(e>window.STEP_CONFIG.length&&(e=window.STEP_CONFIG.length),window.STEP_CONFIG[e-1])},e.prototype.onDestroy=function(){this.m_nodepoll&&this.m_nodepoll.clear()},__decorate([s(cc.SpriteAtlas)],e.prototype,"m_spa_list",void 0),__decorate([s(cc.Node)],e.prototype,"m_n_bigstepcontent",void 0),__decorate([s(cc.Sprite)],e.prototype,"m_sp_mystepicon",void 0),__decorate([s(cc.Sprite)],e.prototype,"m_sp_mystepname",void 0),__decorate([s([cc.Node])],e.prototype,"m_n_mystarlist",void 0),__decorate([s(cc.Prefab)],e.prototype,"m_pre_bigstep",void 0),__decorate([c],e)}(cc.Component);i.default=a,cc._RF.pop()},{"./common/Utils":"Utils"}],GetBoxGiftItem:[function(t,e,i){"use strict";cc._RF.push(e,"30339KHDKlNjZMtkkI4Lrhs","GetBoxGiftItem"),Object.defineProperty(i,"__esModule",{value:!0});var n=t("../common/ShareSdk"),o=t("../common/Utils"),c=t("../common/Common_CommonUtil"),s=cc._decorator,a=s.ccclass,r=s.property,_=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.m_n_freebtn=null,e.m_n_sharebtn=null,e.m_n_box=null,e._onshowback=!1,e._callback=null,e}return __extends(e,t),e.prototype.start=function(){EVENT_LISTENER.on(window.ON_SHOW_BACK,this.onshowback,this)},e.prototype.showView=function(t){this._callback=t,this.m_n_freebtn.active=!window.BOX_SHARE,this.m_n_sharebtn.active=window.BOX_SHARE,this.m_n_box.runAction(cc.sequence(cc.repeat(cc.sequence(cc.rotateTo(.1,-10),cc.rotateTo(.1,10)),3),cc.rotateTo(.1,0)))},e.prototype.onDestroy=function(){EVENT_LISTENER.off(window.ON_SHOW_BACK,this)},e.prototype.onshowback=function(t){this._onshowback&&(t>=window.SHARE_TIME?this.onFreeGet():c.default.showShareFailTips(),this._onshowback=!1)},e.prototype.onClose=function(){this._callback&&(this._callback(),this._callback=null),this.node.active=!1},e.prototype.onFreeGet=function(){var t,e=[1,20];t=o.random(0,1500)>750?0:1,o.showGetItem(e[t],t,null,0,0),0==t?window.INIT_GAME_SAVE_DATA.tool[0]+=e[t]:window.INIT_GAME_SAVE_DATA.gold_num+=e[t],window.GAME_CONTROL&&window.GAME_CONTROL.BoxReward(t),this.onClose()},e.prototype.onShareGet=function(){this._onshowback=!0,n.shareAppMessage({title:"\u6211\u5c31\u770b\u7740\u4f60\uff0c\u76f4\u5230\u4f60\u6253\u5f00\u5b9d\u7bb1\u4e3a\u6b62",imageUrl:window.tempFileURL[3]})},__decorate([r(cc.Node)],e.prototype,"m_n_freebtn",void 0),__decorate([r(cc.Node)],e.prototype,"m_n_sharebtn",void 0),__decorate([r(cc.Node)],e.prototype,"m_n_box",void 0),__decorate([a],e)}(cc.Component);i.default=_,cc._RF.pop()},{"../common/Common_CommonUtil":"Common_CommonUtil","../common/ShareSdk":"ShareSdk","../common/Utils":"Utils"}],GuideManager:[function(t,e){"use strict";cc._RF.push(e,"85665NaV6lFCY6zVqTLmHdP","GuideManager");var i=t("Utils");cc.Class({extends:cc.Component,properties:{m_n_mask:cc.Node,m_n_guide_circle:cc.Node,m_n_bubble1:cc.Node,m_n_bubble2:cc.Node,m_n_confirm:cc.Node,m_sp_maskbg:cc.Node},start:function(){this.node.on(cc.Node.EventType.TOUCH_START,this.touchStart,this),this.node.on(cc.Node.EventType.TOUCH_END,this.touchEnd,this)},showGuide:function(t,e){if(!(window.GUIDE_LEVEL>=t)){if(this.m_cur_tag=t,this.m_cur_index=e,!window.CONFIG_GUIDE[t][e])return this.node.active=!1,window.GUIDE_LEVEL+=1,void cc.sys.localStorage.setItem("guideinfo",""+window.GUIDE_LEVEL);this._guide_data=window.CONFIG_GUIDE[t][e],this.setGuideInfo(this._guide_data),this.node.active||(this.node.active=!0)}},touchStart:function(t){if(2!=this._guide_data.type)if(window.GAME_CONTROL){var e=t.touch.getLocation();if(window.GAME_CONTROL.getTouchIndex(e)!=this._guide_data.target)return this._confirm=!1,void t.stopPropagation();this._confirm=!0}else this.node.active=!1;else t.stopPropagation()},touchEnd:function(){2!=this._guide_data.type&&this._confirm&&this.showNextGuide(),this._confirm=!1},showNextGuide:function(){var t=this;this._guide_data.target=-2,this._guide_data.type=-1,setTimeout(function(){t.m_cur_index+=1,t.showGuide(t.m_cur_tag,t.m_cur_index)},window.CONFIG_GUIDE[this.m_cur_tag][this.m_cur_index].delaytime)},onConfirmClick:function(){i.SetSoundEffect(window.BUTTON_CLICK_MUSIC,!1,1),this.showNextGuide()},setGuideInfo:function(t){this.m_n_bubble1.active=1==t.dir,this.m_n_bubble2.active=2==t.dir;var e=1==t.dir?this.m_n_bubble1:this.m_n_bubble2,i=cc.find("l_guide_desc",e),n=1==t.dir?-1:1;if(i.width=t.descsize[0],i.height=t.descsize[1],i.getComponent(cc.Label).string=t.desc,e.width=t.descsize[0]+100,e.height=t.descsize[1]+50,cc.find("sp_mon",e).y=e.height/2,"string"==typeof t.target){var o=cc.find(t.target);this.m_n_mask.position=o.position,this.m_n_mask.width=o.width+10,this.m_n_mask.height=o.height+10,e.x=this.m_n_mask.x+n*this.m_n_mask.width/2,e.y=this.m_n_mask.y+this.m_n_mask.height/2+t.offsetY,this.m_n_guide_circle.width=this.m_n_mask.width+30,this.m_n_guide_circle.height=this.m_n_mask.height+30,this.m_n_guide_circle.getComponent(cc.Animation).play(),this.m_n_guide_circle.position=this.m_n_mask.position,this.m_sp_maskbg.x=-this.m_n_mask.x,this.m_sp_maskbg.y=-this.m_n_mask.y}else if("number"==typeof t.target)if(-1==t.target)this.m_n_mask.width=0,this.m_n_mask.height=0,this.m_n_guide_circle.width=0,e.y=0,e.x=0;else if(window.GAME_CONTROL){var c=window.GAME_CONTROL.getTargetGridInfo(t.target);this.m_n_mask.position=c.position,this.m_n_mask.width=c.width+10,this.m_n_mask.height=c.height+10,e.x=this.m_n_mask.x+n*this.m_n_mask.width/2,e.y=this.m_n_mask.y+this.m_n_mask.height/2+t.offsetY,this.m_n_guide_circle.width=this.m_n_mask.width+30,this.m_n_guide_circle.height=this.m_n_mask.height+30,this.m_n_guide_circle.getComponent(cc.Animation).play(),this.m_n_guide_circle.position=this.m_n_mask.position,this.m_sp_maskbg.x=-this.m_n_mask.x,this.m_sp_maskbg.y=-this.m_n_mask.y}2==t.type?(this.m_n_confirm.active=!0,this.m_n_confirm.x=e.x+n*e.width/2,this.m_n_confirm.y=e.y-40):this.m_n_confirm.active=!1}}),cc._RF.pop()},{Utils:"Utils"}],MonsterItem:[function(t,e){"use strict";cc._RF.push(e,"cd58clmrdZOZpvuvyzBbabD","MonsterItem");var i=t("Utils");cc.Class({extends:cc.Component,properties:{_mon_id:0,_hp:0,m_n_talk:cc.Node,m_l_talk:cc.Label,m_n_bloodmask:cc.Node,m_sp_blood:cc.Node,m_l_blood:cc.Label,m_n_behit:cc.Node,m_n_stand:cc.Node,boss1:sp.SkeletonData,boss2:sp.SkeletonData,boss3:sp.SkeletonData,n_bloodbg:cc.Node,l_level:cc.Node},start:function(){},initType:function(t,e,i,n){switch(cc.log("monsterid:"+t+" hp:"+e+" level:"+i),this._mon_id=t,this._hp=e,this._all_hp=e,this.m_l_blood.string=this._hp,this.m_n_bloodmask.width=this.m_sp_blood.width,this._noangry=!0,this.node.getComponent(sp.Skeleton).skeletonData=this["boss"+n],n){case 1:this.n_bloodbg.y=213.5,this.l_level.y=279;break;case 2:this.n_bloodbg.y=250.48,this.l_level.y=315.98;break;case 3:this.n_bloodbg.y=247.48,this.l_level.y=312.98}void 0!==window.MONSTER_CONFIG[t]&&(this.node.scale=1.3)},reduceHp:function(t){return cc.log("hp:"+this._hp+" hurt:"+t),this._hp-=t,this._hp<0&&(this._hp=0),this.m_l_blood.string=this._hp,this.m_n_bloodmask.width=this._hp/this._all_hp*this.m_sp_blood.width,this._hp},addHp:function(t){return this._hp+=t,this._hp>this._all_hp&&(this._all_hp=this._hp),this.m_l_blood.string=this._hp,this.m_n_bloodmask.width=this._hp/this._all_hp*this.m_sp_blood.width,this._hp},playBeHitEffect:function(){},playBeHit:function(){this.node.getComponent(sp.Skeleton).setAnimation(0,"hit",!1),this.playBeHitEffect()},playBeHapply:function(){this._mon_id},beHitFinish:function(){},playNormal:function(){this.talkNormal()},playAttack:function(){this.playBeHapply(),this.talkAttack()},playDead:function(){return this.node.runAction(cc.fadeOut(3)),this.m_n_stand.runAction(cc.fadeOut(3)),this.schedule(function(){this.playBeHit()},.3,2,0),this.talkFail(),3e3},playStartTalk:function(){this.playBeHapply(),this.talkStart(),this.m_n_stand.opacity=100},playMonsterVictory:function(){this.playBeHapply(),this.talkVictory()},playHappyTalk:function(){this.talkHappy(),this.playBeHapply()},playAngry:function(){this._noangry&&(this.talkAngry(),this._noangry=!1)},talkHappy:function(t){if(window.MONSTER_CONFIG[this._mon_id]){"number"!=typeof t&&(t=i.random(0,window.MONSTER_CONFIG[this._mon_id].happy_talk.length));var e=window.MONSTER_CONFIG[this._mon_id].happy_talk[t];this.m_l_talk.string=e,this.node.getComponent(sp.Skeleton).setAnimation(0,"idle",!0)}},talkStart:function(t){if(window.MONSTER_CONFIG[this._mon_id]){"number"!=typeof t&&(t=i.random(0,window.MONSTER_CONFIG[this._mon_id].start_talk.length));var e=window.MONSTER_CONFIG[this._mon_id].start_talk[t];this.m_l_talk.string=e,this.node.getComponent(sp.Skeleton).setAnimation(0,"idle",!0)}},talkAngry:function(t){if(window.MONSTER_CONFIG[this._mon_id]){"number"!=typeof t&&(t=i.random(0,window.MONSTER_CONFIG[this._mon_id].angry_talk.length));var e=window.MONSTER_CONFIG[this._mon_id].angry_talk[t];this.m_l_talk.string=e,this.node.getComponent(sp.Skeleton).setAnimation(0,"idle",!0)}},talkFail:function(t){if(window.MONSTER_CONFIG[this._mon_id]){"number"!=typeof t&&(t=i.random(0,window.MONSTER_CONFIG[this._mon_id].fail_talk.length));var e=window.MONSTER_CONFIG[this._mon_id].fail_talk[t];this.m_l_talk.string=e}},talkVictory:function(t){if(window.MONSTER_CONFIG[this._mon_id]){"number"!=typeof t&&(t=i.random(0,window.MONSTER_CONFIG[this._mon_id].victoy_talk.length));var e=window.MONSTER_CONFIG[this._mon_id].victoy_talk[t];this.m_l_talk.string=e,this.node.getComponent(sp.Skeleton).setAnimation(0,"idle",!0)}},talkNormal:function(t){if(window.MONSTER_CONFIG[this._mon_id]){"number"!=typeof t&&(t=i.random(0,window.MONSTER_CONFIG[this._mon_id].normal_talk.length));var e=window.MONSTER_CONFIG[this._mon_id].normal_talk[t];this.m_l_talk.string=e,this.node.getComponent(sp.Skeleton).setAnimation(0,"idle",!0)}},talkAttack:function(t){if(window.MONSTER_CONFIG[this._mon_id]){"number"!=typeof t&&(t=i.random(0,window.MONSTER_CONFIG[this._mon_id].attack_talk.length));var e=window.MONSTER_CONFIG[this._mon_id].attack_talk[t];this.m_l_talk.string=e,this.node.getComponent(sp.Skeleton).setAnimation(0,"idle",!0)}}}),cc._RF.pop()},{Utils:"Utils"}],NewBieGift:[function(t,e){"use strict";cc._RF.push(e,"ff138Fh57NHHqstEbjYQe72","NewBieGift");var i=t("Utils"),n=t("ShareSdk"),o=function(){var t=new Date,e=t.getFullYear()+"/"+(t.getMonth()+1)+"/"+t.getDate(),i=e.split("/");return[e,i]};cc.Class({extends:cc.Component,properties:{m_n_newpanel:cc.Node,m_n_newpanel_success:cc.Node,m_btn_getreward:cc.Button,m_l_desc:cc.Label},start:function(){this.m_n_newpanel.active=!1,this.m_n_newpanel_success.active=!1,EVENT_LISTENER.on(window.ON_SHOW_BACK,this.onshowback,this),this.updateData()},onEnable:function(){},onDisable:function(){},onDestroy:function(){EVENT_LISTENER.off(window.ON_SHOW_BACK,this)},onshowback:function(){this._onshowback&&(this._onshowback=!1,this.m_n_newpanel_success.active&&(this.m_n_newpanel_success.active=!1))},autoShowRewardPage:function(){1==this.getState()&&(window.firststart||(this.onBtnNewBieClick(),window.firststart=!0))},getState:function(){var t=1,e=window.INIT_GAME_SAVE_DATA.login_time;if(e&&"null"!=e&&""!=e){var i=e.split("/"),n=o(),c=(n[0],n[1]);t=this.judgeTime(i,c)}return t},judgeTime:function(t,e){if(parseInt(t[0])<parseInt(e[0]))return 1;if(parseInt(t[0])>parseInt(e[0]))return-1;if(parseInt(t[1])<parseInt(e[1]))return 1;if(parseInt(t[1])>parseInt(e[1]))return-1;var i=0;return parseInt(t[2])<parseInt(e[2])?i=1:parseInt(t[2])>parseInt(e[2])&&(i=-1),i},updateData:function(){this.autoShowRewardPage(),1==this.getState()?(this.m_btn_getreward.interactable=!0,this.m_l_desc.string="\u6bcf\u5929\u53ef\u9886\u4e00\u6b21"):(this.m_btn_getreward.interactable=!1,this.m_l_desc.string="\u6bcf\u5929\u53ef\u9886\u4e00\u6b21(\u5df2\u9886\u53d6)")},onBtnNewBieClick:function(){i.SetSoundEffect(window.BUTTON_CLICK_MUSIC,!1,1),1==this.getState()?(this.m_btn_getreward.interactable=!0,this.m_l_desc.string="\u6bcf\u5929\u53ef\u9886\u4e00\u6b21"):(this.m_btn_getreward.interactable=!1,this.m_l_desc.string="\u6bcf\u5929\u53ef\u9886\u4e00\u6b21(\u5df2\u9886\u53d6)")},onBackBtnClick:function(){i.SetSoundEffect(window.BUTTON_CLICK_MUSIC,!1,1),this.m_n_newpanel.active=!1,this.m_n_newpanel_success.active=!1},onRewardBackBtnClick:function(){i.SetSoundEffect(window.BUTTON_CLICK_MUSIC,!1,1),this.m_n_newpanel.active=!1,this.m_n_newpanel_success.active=!1},onBtnGetRewardClick:function(){i.SetSoundEffect(window.BUTTON_CLICK_MUSIC,!1,1),this.m_n_newpanel.active=!1,this.m_n_newpanel_success.active=!0;var t=o()[0];this._onshowback=!0,window.INIT_GAME_SAVE_DATA.login_time=t,window.INIT_GAME_SAVE_DATA.tool[0]+=1,window.INIT_GAME_SAVE_DATA.gold_num+=10,this.updateData(),window.GAME_MENU&&window.GAME_MENU.updateGold()},onShareBtnClick:function(){i.SetSoundEffect(window.BUTTON_CLICK_MUSIC,!1,1);var t=this;n.shareAppMessage({title:"\u70b8\u5f39\uff0c\u91d1\u5e01\u6bcf\u5929\u9886\uff0c\u5feb\u6765\u9886\u53d6\u5427",imageUrl:window.tempFileURL[0],success:function(){t.m_n_sharenode.active=!0},fail:function(){},complate:function(){}})}}),cc._RF.pop()},{ShareSdk:"ShareSdk",Utils:"Utils"}],PlatformCom:[function(t,e){"use strict";cc._RF.push(e,"80373H/aPBOV7m+lx9Wa0iH","PlatformCom"),cc.Class({extends:cc.Component,properties:{},onLoad:function(){this.node.zindex=100,cc.view.getVisibleSize(),this.m_callbackobj=null},start:function(){},onImageBtnClick:function(){wx.previewImage({urls:["https://h5game.gametall.com/chatgame/cocos_games_res/images/codeImage.jpg"]})},onSaveImageBtnClick:function(){if(window.isWeChatPlatform){var t=this;wx.saveImageToPhotosAlbum({filePath:cc.url.raw("resources/common/saveImage.d2e1c.jpg"),success:function(){t.showTipsView("\u4e8c\u7ef4\u7801\u5df2\u4fdd\u5b58\u6210\u529f")},fail:function(){wx.openSetting({authSetting:"scope.writePhotosAlbum",success:function(){},fail:function(){}})}})}},onCloseBtnClick:function(){this.m_rqcode.active=!1},hideTipsView:function(){this.m_tips.getChildByName("TipsTex").getComponent(cc.Label).string="",this.m_tips.active=!1},showTipsView:function(t){this.m_tips.getChildByName("TipsTex").getComponent(cc.Label).string=t,this.m_tips.active=!0}}),cc._RF.pop()},{}],PureMVC:[function(t,e){"use strict";var i;cc._RF.push(e,"01faa7O74JKEa1IQ/losA0i","PureMVC"),function(t){var e=function(){};t.Observer=e;var i=function(){function t(){this.facade=r.getInstance()}return t.prototype.sendNotification=function(t,e){this.facade.sendNotification(t,e)},t}();t.Notifier=i;var n=function(t){function e(e,i){var n=t.call(this)||this;if(void 0===e)throw Error("Invalid Proxy Name");return n.proxyName=e,void 0!==i&&(n.data=i),n}return __extends(e,t),e.prototype.getProxyName=function(){return this.proxyName||null},e.prototype.onRegister=function(){},e.prototype.onRemove=function(){},e.prototype.setData=function(t){this.data=t},e.prototype.getData=function(){return this.data},e}(i);t.Proxy=n;var o=function(){function t(){if(this.commands={},null!==t.inst)throw Error(t.SINGLETON_MSG);t.inst=this}return t.prototype.executeCommand=function(t,e){var i=new(0,this.commands[t]);void 0===e?i.execute.call(i):e instanceof Array?i.execute.apply(i,e):i.execute.call(i,e)},t.prototype.registerCommand=function(t,e){if(!0===this.hasCommand(t))throw Error("Register Duplicate Command "+t);this.commands[t]=e,s.inst.registerObserver(t,this.executeCommand,this)},t.prototype.removeCommand=function(t){if(!1===this.hasCommand(t))throw Error("Remove Non-Existent Command "+t);delete this.commands[t],s.inst.removeObserver(t,this.executeCommand,this)},t.prototype.retrieveCommand=function(t){return this.commands[t]||null},t.prototype.hasCommand=function(t){return null!=this.retrieveCommand(t)},t.SINGLETON_MSG="Controller singleton already constructed!",t.inst=null,t}();t.Controller=o;var c=function(){function t(){if(this.proxies={},null!==t.inst)throw Error(t.SINGLETON_MSG);t.inst=this}return t.prototype.registerProxy=function(t){var e=t.getProxyName();if(null===e)throw Error("Register Invalid Proxy");if(!0===this.hasProxy(e))throw Error("Register Duplicate Proxy "+e);this.proxies[e]=t,t.onRegister()},t.prototype.removeProxy=function(t){if(void 0===t)throw Error("Remove Invalid Proxy");var e=this.retrieveProxy(t);if(null===e)throw Error("Remove Non-Existent Proxy "+t);delete this.proxies[t],e.onRemove()},t.prototype.retrieveProxy=function(t){return this.proxies[t]||null},t.prototype.hasProxy=function(t){return null!=this.retrieveProxy(t)},t.SINGLETON_MSG="Model singleton already constructed!",t.inst=null,t}();t.Model=c;var s=function(){function t(){if(this.mediators={},this.observers={},this.isCanceled=!1,this.onceObservers=[],null!==t.inst)throw Error(t.SINGLETON_MSG);t.inst=this}return t.prototype.registerObserver=function(t,i,n,o){if(void 0===o&&(o=1),void 0===t)throw Error("Register Invalid Observer");if(void 0===i)throw Error("Register Invalid Observer Method");var c=this.observers[t];void 0===c?c=this.observers[t]=[!1]:!0===c[0]&&((c=this.observers[t]=c.concat())[0]=!1);for(var s=-1,a=1;a<c.length;a++){var r=c[a];if(r.method===i&&r.caller===n)return null;-1===s&&r.priority<o&&(s=a)}var _=new e;return _.name=t,_.caller=n,_.method=i,_.priority=o,s<0?c.push(_):c.splice(s,0,_),_},t.prototype.removeObserver=function(t,e,i){if(void 0===t)throw Error("Remove Invalid Observer");if(void 0===e)throw Error("Remove Invalid Observer Method");var n=this.observers[t];if(void 0!==n){!0===n[0]&&((n=this.observers[t]=n.concat())[0]=!1);for(var o=1;o<n.length;o++){var c=n[o];if(c.method===e&&c.caller===i){n.splice(o,1);break}}1===n.length&&delete this.observers[t]}},t.prototype.notifyCancel=function(){this.isCanceled=!0},t.prototype.notifyObservers=function(t,e){if(void 0===t)throw Error("Notify Invalid Command");var i=this.observers[t];if(void 0!==i){i[0]=!0;for(var n=1;n<i.length;n++){var c=i[n];c.caller===o.inst?c.method.call(c.caller,t,e):void 0===e?c.method.call(c.caller):e instanceof Array?c.method.apply(c.caller,e):c.method.call(c.caller,e)}i[0]=!1}},t.prototype.registerMediator=function(t){var e=t.getMediatorName();if(null===e)throw Error("Register Invalid Mediator");if(!0===this.hasMediator(e))throw Error("Register Duplicate Mediator "+e);this.mediators[e]=t,t.listNotificationInterests(),t.onRegister()},t.prototype.removeMediator=function(t){if(void 0===t)throw Error("Remove Invalid Mediator");var e=this.retrieveMediator(t);if(null===e)throw Error("Remove Non-Existent Mediator "+t);delete this.mediators[t],e.removeNotificationInterests(),e.onRemove()},t.prototype.retrieveMediator=function(t){return this.mediators[t]||null},t.prototype.hasMediator=function(t){return null!=this.retrieveMediator(t)},t.SINGLETON_MSG="View singleton already constructed!",t.inst=null,t}();t.View=s;var a=function(t){function e(e,i){var n=t.call(this)||this;if(n.notificationInterests=[],void 0===e)throw Error("Invalid Mediator Name");if(void 0===i)throw Error("Invalid View Component");return n.mediatorName=e,void 0!==i&&(n.viewComponent=i),n}return __extends(e,t),e.prototype.getMediatorName=function(){return this.mediatorName||null},e.prototype.getViewComponent=function(){return this.viewComponent},e.prototype.listNotificationInterests=function(){},e.prototype.removeNotificationInterests=function(){for(var t=0;t<this.notificationInterests.length;t++){var e=this.notificationInterests[t];s.inst.removeObserver(e.name,e.method,e.caller)}},e.prototype.handleNotification=function(t,e){var i=s.inst.registerObserver(t,e,this);i&&this.notificationInterests.push(i)},e.prototype.onRegister=function(){},e.prototype.onRemove=function(){},e}(i);t.Mediator=a;var r=function(){function t(){if(this.view=new s,this.model=new c,this.controller=new o,null!==t.inst)throw Error(t.SINGLETON_MSG);t.inst=this,this.initializeFacade()}return t.getInstance=function(){return null===t.inst&&(t.inst=new t),t.inst},t.prototype.initializeFacade=function(){this.initializeModel(),this.initializeView(),this.initializeController()},t.prototype.initializeModel=function(){},t.prototype.initializeView=function(){},t.prototype.initializeController=function(){},t.prototype.registerObserver=function(t,e,i,n){this.view.registerObserver(t,e,i,n)},t.prototype.removeObserver=function(t,e,i){this.view.removeObserver(t,e,i)},t.prototype.registerCommand=function(t,e){this.controller.registerCommand(t,e)},t.prototype.removeCommand=function(t){this.controller.removeCommand(t)},t.prototype.hasCommand=function(t){return this.controller.hasCommand(t)},t.prototype.registerProxy=function(t){this.model.registerProxy(t)},t.prototype.removeProxy=function(t){this.model.removeProxy(t)},t.prototype.retrieveProxy=function(t){return this.model.retrieveProxy(t)},t.prototype.hasProxy=function(t){return this.model.hasProxy(t)},t.prototype.registerMediator=function(t){this.view.registerMediator(t)},t.prototype.removeMediator=function(t){this.view.removeMediator(t)},t.prototype.retrieveMediator=function(t){return this.view.retrieveMediator(t)},t.prototype.hasMediator=function(t){return this.view.hasMediator(t)},t.prototype.sendNotification=function(t,e){this.view.notifyObservers(t,e)},t.prototype.notifyCancel=function(){this.view.notifyCancel()},t.SINGLETON_MSG="Facade singleton already constructed!",t.inst=null,t}();t.Facade=r;var _=function(t){function e(){var e=t.call(this)||this;return e.commands=[],e.initializeMacroCommand(),e}return __extends(e,t),e.prototype.addSubCommand=function(t){this.commands.push(t)},e.prototype.execute=function(){for(var t=0;t<this.commands.length;t++){var e=this.commands[t],i=new e;i.execute.apply(i,arguments)}},e}(i);t.MacroCommand=_;var h=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e}(i);t.SimpleCommand=h}(i||(i={})),cc._RF.pop()},{}],RankList:[function(t,e){"use strict";cc._RF.push(e,"0dc77eqhXNCk68n5Q8vi7mz","RankList"),e.exports={setScore:function(t,e,i,n){"undefined"!=typeof wx&&wx.setUserCloudStorage({KVDataList:[{key:"score",value:t+""}],success:e||null,fail:i||null,complete:n||null})},showFriendList:function(){"undefined"!=typeof wx&&wx.postMessage({rankType:1})},showGroupList:function(t){"undefined"!=typeof wx&&wx.postMessage({shareTicket:t,rankType:0})},showGameResultList:function(){"undefined"!=typeof wx&&wx.postMessage({rankType:2})},checkSurpassFriend:function(t,e,i){"undefined"!=typeof wx&&wx.postMessage({rankType:3,score:t,x:e||0,y:i||0})},checkWillSurpass:function(t,e){"undefined"!=typeof wx&&wx.postMessage({rankType:4,score:t,y:e||500})}},cc._RF.pop()},{}],ReliveViewCtrl:[function(t,e){"use strict";cc._RF.push(e,"4d005XrCjBOra87fNF1fOrG","ReliveViewCtrl");var i,n=(i=t("../dataStatistics/Data"))&&i.__esModule?i:{default:i};cc.Class({extends:cc.Component,properties:{Score:cc.Label,TimeTex:cc.Label,m_cost_numlabel:cc.Label,TimeNum:null,skipBtn:cc.Node,m_cost_pic:cc.Sprite,m_bg:cc.Node,m_share_relive:cc.Node,m_btn_share:cc.Button,m_sp_all_gold:cc.Sprite,m_l_all_gold:cc.Label},start:function(){this.node.zindex=100,this.TimeNum=10,this.TimeTex.string=this.TimeNum,this.timeOut=!1,this.m_cost_num=window.RELIVE_COST_NUM;var t=cc.winSize;this.m_bg.width=t.width,this.m_bg.height=t.height;var e=this;cc.loader.loadRes(window.RELIVE_COST_PIC_PATH,cc.SpriteFrame,function(t,i){t?cc.error(t.message||t):(e.m_cost_pic.spriteFrame=i,e.m_sp_all_gold.spriteFrame=i)}),this.m_cost_numlabel.string="x"+window.RELIVE_COST_NUM,this.m_l_all_gold.string=":"+window.INIT_GAME_SAVE_DATA.gold_num,window.isWeChatPlatform&&e.setShareReliveShow(window.SHARE_RELIVE)},setShareReliveShow:function(t){this.m_share_relive.active=0!=t},setCallBackObj:function(t){this.callbackobj=t},ShowView:function(t){this.node.active=t,!0===t&&this.callbackobj&&this.callbackobj.shareObj&&(this.callbackobj.shareObj.is_share_relive?this.m_btn_share.interactable=!1:this.m_btn_share.interactable=!0),!1===t&&this.node.destroy()},CountDownClick:function(t){this.schedule(this.DeleteTimeNum,1,t,0,!0)},DeleteTimeNum:function(){this.TimeNum-=1,this.TimeTex.string=this.TimeNum,this.TimeNum<=-1&&(this.TimeTex.string=0,this.ShowView(!1),null!=this.callbackobj&&this.callbackobj.onSkipCallBack())},CoinBtnClick:function(){null!=this.callbackobj&&this.callbackobj.onCostRelive(this.m_cost_num)&&this.ShowView(!1)},setScoreLabel:function(t){this.Score.string=t+""},setCostNumLabel:function(t){this.m_cost_numlabel.string="x"+t,this.m_cost_num=parseInt(t)},ShareBtnClick:function(){if(this.unschedule(this.DeleteTimeNum),window.wx){var t=this;if(null!=this.callbackobj){var e=this.callbackobj.shareObj;n.default.share(EChannelPrefix.resurrection,"",null,function(i){i.shareTickets?(e.success&&e.success(i),t.ShowView(!1)):Utils.showTipsText("\u5206\u4eab\u5931\u8d25\uff0c\u8bf7\u5206\u4eab\u5230\u7fa4",null,0,0,80)},function(){e.fail&&e.fail()},function(){e.complete&&e.complete()})}}},cancelBtnClick:function(){this.unschedule(this.DeleteTimeNum),this.ShowView(!1),null!=this.callbackobj&&this.callbackobj.onSkipCallBack()}}),cc._RF.pop()},{"../dataStatistics/Data":"Data"}],RockItem:[function(t,e){"use strict";cc._RF.push(e,"80ebb/V4PBKUao1TiZ5JV+M","RockItem"),cc.Class({extends:cc.Component,properties:{m_partice:cc.ParticleSystem},start:function(){},resetSytem:function(){this.m_partice.resetSystem()}}),cc._RF.pop()},{}],ShapeItem:[function(t,e){"use strict";cc._RF.push(e,"f7756iw0ZVBxpZpYOFetAz7","ShapeItem");var i=t("Utils"),n=t("GameMain"),o=["#ffffff","#f9bd1d","#003DFF","#85d546","#D6309A"];cc.Class({extends:cc.Component,properties:{m_spa_blocklist:cc.SpriteAtlas,table1:cc.SpriteFrame,table2:cc.SpriteFrame,table3:cc.SpriteFrame,table4:cc.SpriteFrame,GameLayer:{default:null,type:n}},start:function(){this._bg_color=0,this._type_index=0,this._colorindex=1,window.INIT_GAME_SAVE_DATA.top_level<1&&!window.GUIDE_LEVEL?(this.resetBlock(22),this.GameLayer.showGuide()):this.resetBlock(),this.addTouchEvent(),this._blockcount=0},updateIndex:function(t){for(var e=window.INIT_GAME_SAVE_DATA.skin,i=0;i<e.length;i++)if(e[i]>=2){this._type_index=i;break}if(this._data=window.SKIN_CONFIG[this._type_index],t){var n=this.node.getChildByName("n_shape");if(n)for(var o=0;o<n.childrenCount;o++)n.children[o].getComponent(cc.Sprite).spriteFrame=this.m_spa_blocklist.getSpriteFrame(this._data.name+this._colorindex)}return this._type_index},getTheConfig:function(){var t=109.77249200050075,e=110,i=Math.cos(60*Math.PI/180),n=Math.sin(60*Math.PI/180),o=Math.cos(120*Math.PI/180),c=Math.sin(120*Math.PI/180),s=Math.cos(300*Math.PI/180),a=Math.sin(300*Math.PI/180);return[[cc.v2(0,0)],[cc.v2(0,0),cc.v2(e,0),cc.v2(220,0),cc.v2(330,0)],[cc.v2(0,0),cc.v2(e,0),cc.v2(220,0),cc.v2(e+i*t,n*t)],[cc.v2(0,0),cc.v2(e,0),cc.v2(220,0),cc.v2(e+s*t,a*t)],[cc.v2(0,0),cc.v2(e,0),cc.v2(220,0),cc.v2(i*t,n*t)],[cc.v2(0,0),cc.v2(e,0),cc.v2(220,0),cc.v2(s*t,a*t)],[cc.v2(0,0),cc.v2(i*t,n*t),cc.v2(i*t*2,n*t*2),cc.v2(o*t,c*t)],[cc.v2(0,0),cc.v2(i*t,n*t),cc.v2(i*t*2,n*t*2),cc.v2(o*t+i*t,c*t+n*t)],[cc.v2(0,0),cc.v2(i*t,n*t),cc.v2(i*t*2,n*t*2),cc.v2(e,0)],[cc.v2(0,0),cc.v2(i*t,n*t),cc.v2(i*t*2,n*t*2),cc.v2(i*t+e,n*t)],[cc.v2(0,0),cc.v2(i*t,n*t),cc.v2(i*t*2,n*t*2),cc.v2(i*t*3,n*t*3)],[cc.v2(0,0),cc.v2(o*t,c*t),cc.v2(o*t*2,c*t*2),cc.v2(o*t*2+e,c*t*2)],[cc.v2(0,0),cc.v2(o*t,c*t),cc.v2(o*t*2,c*t*2),cc.v2(o*t-e,c*t)],[cc.v2(0,0),cc.v2(o*t,c*t),cc.v2(o*t*2,c*t*2),cc.v2(o*t+e,c*t)],[cc.v2(0,0),cc.v2(o*t,c*t),cc.v2(o*t*2,c*t*2),cc.v2(-e,0)],[cc.v2(0,0),cc.v2(o*t,c*t),cc.v2(o*t*2,c*t*2),cc.v2(o*t*3,c*t*3)],[cc.v2(0,0),cc.v2(i*t,n*t),cc.v2(i*t+e,n*t),cc.v2(220,0)],[cc.v2(0,0),cc.v2(s*t,a*t),cc.v2(s*t+e,a*t),cc.v2(220,0)],[cc.v2(0,0),cc.v2(o*t,c*t),cc.v2(0,190),cc.v2(e,190)],[cc.v2(0,0),cc.v2(i*t,n*t),cc.v2(0,190),cc.v2(-e,190)],[cc.v2(0,0),cc.v2(o*t,c*t),cc.v2(0,190),cc.v2(e,0)],[cc.v2(0,0),cc.v2(i*t,n*t),cc.v2(0,190),cc.v2(-e,0)],[cc.v2(0,0),cc.v2(o*t,c*t),cc.v2(0,190),cc.v2(s*t,190+a*t)],[cc.v2(0,0),cc.v2(i*t,n*t),cc.v2(e,0),cc.v2(i*t+e,n*t)],[cc.v2(0,0),cc.v2(o*t,c*t),cc.v2(-e,0),cc.v2(o*t-e,c*t)]]},newOneK:function(t){var e=new cc.Node("colorSpr");return e.colorIndex=t,e.colorName=this._data.name,e.addComponent(cc.Sprite).spriteFrame=this["table"+this._colorindex],this.scheduleOnce(function(){e.width=104,e.height=114},1/60),e},getCurColorIndex:function(){return this._colorindex},createItem:function(t){this._blockcount++,this._blockcount>=5&&(this._next=0,this._blockcount=0),"number"!=typeof this._next||t||(t=this._next,this._next=null,0==t&&(this._blockcount=0));var e=new cc.Node("n_shape"),n=this.getTheConfig(),c=i.random(0,n.length);"number"==typeof t&&t>=0&&(c=t),0==c&&(this._blockcount=0);var s=n[c],a=i.random(1,5);this._bg_color=o[a],this._colorindex=a;for(var r=0,_=0,h=0,l=0,m=0;m<s.length;m++){var d=s[m],u=this.newOneK(a);u.x=d.x,r+=u.x,_++,u.y=d.y,h+=u.y,l++,e.addChild(u)}return e.setScale(.5),e.x=-r/_*.5,e.y=-h/l*.5,e},addTouchEvent:function(){var t=this;this.node.ox=this.node.x,this.node.oy=this.node.y,this.node.on(cc.Node.EventType.TOUCH_START,function(){this.node.y+=130,i.SetSoundEffect(window.BUTTON_CLICK_MUSIC,!1,.8),this.node.getChildByName("n_shape").setScale(1)},this),this.node.on(cc.Node.EventType.TOUCH_MOVE,function(e){var i=e.touch.getDelta();this.node.x+=i.x,this.node.y+=i.y,t.collisionFunc(),t.checkIsCanDrop()?t.changeColorDeal():t.changeColorDeal(!0)},this),this.node.on(cc.Node.EventType.TOUCH_CANCEL,function(){this.dropDownFunc()},this),this.node.on(cc.Node.EventType.TOUCH_END,function(){this.dropDownFunc()},this)},checkIsCanDrop:function(){if(!this._checkFrameList||0==this._checkFrameList.length||this._checkFrameList.length!=this.node.children[0].children.length)return!1;for(var t=0;t<this._checkFrameList.length;t++)if(this._checkFrameList[t].isHaveFK)return!1;return!0},changeColorDeal:function(t){for(var e=this.GameLayer.m_maparray,i=0;i<e.length;i++)e[i].getComponent("BlockBGItem").setBrightVisible(!1);if(!t)for(var n=0;n<this._checkFrameList.length;n++)this._checkFrameList[n].getComponent("BlockBGItem").setBrightVisible(!0,this._bg_color)},collisionFunc:function(){this._checkFrameList=[],this._checkFKlist=[];for(var t=this.node.children[0].children,e=0;e<t.length;e++){var i=cc.v2(this.node.children[0].x,this.node.children[0].y).add(cc.v2(t[e].x,t[e].y)),n=this.node.position.add(i),o=this.checkPosFunc(n);o&&(this._checkFKlist.push(t[e]),this._checkFrameList.push(o))}},checkPosFunc:function(t){for(var e=this.GameLayer.m_maparray,i=0;i<e.length;i++){var n=e[i];if(cc.v2(n.x,n.y).sub(t).mag()<=52)return n}},dropDownFunc:function(){if(this.checkIsCanDrop()){for(var t=0;t<this._checkFKlist.length;t++)this._checkFKlist[t].x=0,this._checkFKlist[t].y=0,this._checkFKlist[t].parent=this._checkFrameList[t],this._checkFrameList[t].isHaveFK=!0,this._checkFKlist[t].runAction(cc.sequence(cc.scaleTo(.1,1.1,.8),cc.scaleTo(.15,.9,1.1),cc.scaleTo(.015,1.1,.9),cc.scaleTo(.2,1,1)));this.GameLayer.hideGuide(),this.node.removeAllChildren();var e=this.createItem();this.node.addChild(e),i.SetSoundEffect(window.BUTTON_CLICK_MUSIC,!1,.8),this.GameLayer.addScore(this._checkFKlist.length,!0),this.GameLayer.checkClearUp(),this.takeBack(),this.GameLayer.checkIsLose()}else this.takeBack()},takeBack:function(){this.checkFrameList=[],this.changeColorDeal(!0),this.node.getChildByName("n_shape").setScale(.5),this.node.x=this.node.ox,this.node.y=this.node.oy},checkIsLose:function(){for(var t=0,e=this.node.children[0].children,i=0;i<this.GameLayer.m_maparray.length;i++){var n=this.GameLayer.m_maparray[i],o=cc.v2(n.x,n.y),c=1;if(!n.isHaveFK){for(var s=1;s<e.length;s++)for(var a=o.add(cc.v2(e[s].x,e[s].y)),r=0;r<this.GameLayer.m_maparray.length;r++){var _=this.GameLayer.m_maparray[r];cc.v2(_.x,_.y).sub(a).mag()<=52&&!_.isHaveFK&&c++}c==e.length&&t++}}return 0==t},resetBlock:function(t){this.node.removeAllChildren(),this.updateIndex();var e=this.createItem(t);this.node.addChild(e)},setNextBlock:function(t){this._next=t}}),cc._RF.pop()},{GameMain:"GameMain",Utils:"Utils"}],ShareSdk:[function(t,e){"use strict";var i;cc._RF.push(e,"7d3cacY8olAOYvE5ne5QRwi","ShareSdk"),(i=t("../dataStatistics/Data"))&&i.__esModule;var n=cc.sys.platform==cc.sys.WECHAT_GAME,o={setShareMenuEnabled:function(t,e){if(n){var i=!!e;t?wx.showShareMenu({withShareTicket:i}):wx.hideShareMenu({})}},onShareAppMessage:function(t){n&&wx.onShareAppMessage(t)},shareAppMessage:function(t){if(n){if("object"!=typeof t)return void console.log("param 'object' is not a js object ");if(void 0===t.title)return void console.log("param 'object' property title is undefined!");wx.shareAppMessage(t)}},openReliveView:function(t,e,i){var n=cc.instantiate(t);null!=i&&cc.isValid(i)?n.parent=i:(i=cc.find("Canvas"),n.parent=i);var o=n.getComponent("ReliveViewCtrl");o.setCallBackObj(e),e.cost_num&&o.setCostNumLabel(e.cost_num),o.setScoreLabel(e.score),o.ShowView(!0)},shareScoreMessage:function(t,e,i){if(n){var o=e||"\u672c\u5c40\u5f97\u4e86"+t+"\u5206\uff0c\u6ca1\u6709\u529e\u6cd5\uff0c\u6211\u5c31\u662f\u8fd9\u4e48\u5f3a\u5927\uff01";wx.shareAppMessage({title:o,imageUrl:cc.url.raw(i)})}},addRqCodeView:function(t,e,i,n){var o=i||0,c=n||0,s=cc.instantiate(t);null!=e&&cc.isValid(e)?s.parent=e:(e=cc.find("Canvas"),s.parent=e),s.setPosition(o,c)},showFriendRankView:function(){},showGroupRankView:function(){}};e.exports=o,cc._RF.pop()},{"../dataStatistics/Data":"Data"}],ShareTipsItem:[function(t,e,i){"use strict";cc._RF.push(e,"1f2f9a3C/VEPKUtTZG0WhFn","ShareTipsItem"),Object.defineProperty(i,"__esModule",{value:!0});var n=cc._decorator,o=n.ccclass,c=(n.property,function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.start=function(){},e.prototype.onClose=function(){this.node.destroy()},__decorate([o],e)}(cc.Component));i.default=c,cc._RF.pop()},{}],SkinItem:[function(t,e,i){"use strict";cc._RF.push(e,"8d8bfr8qONJh5sm29g/5CCH","SkinItem"),Object.defineProperty(i,"__esModule",{value:!0});var n=t("../common/Common_CommonUtil"),o=t("../common/ShareSdk"),c=cc._decorator,s=c.ccclass,a=c.property,r=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.m_l_goldlabel=null,e.m_sp_blockstyle=null,e.m_n_isready=null,e.m_btn_suitup=null,e.m_l_sharetext=null,e._data=null,e._state=0,e._index=0,e._onshowback=!1,e}return __extends(e,t),e.prototype.start=function(){EVENT_LISTENER.on(window.ON_SHOW_BACK,this.onshowback,this)},e.prototype.onDestroy=function(){EVENT_LISTENER.off(window.ON_SHOW_BACK,this)},e.prototype.updateData=function(t,e,i){this._index=t,this._data=e;var n=window.INIT_GAME_SAVE_DATA.skin[t];this._state=n||0,this.m_sp_blockstyle.spriteFrame=i,this.m_n_isready.active=this._state>=2,this.m_btn_suitup.node.active=this._state<2,this.m_l_goldlabel.string=e.price,0==this._state?(1==e.way&&window.SKIN_SHARE?(this.m_l_sharetext.node.active=!0,this.m_l_goldlabel.node.parent.active=!1,this.m_btn_suitup.interactable=!0):(this.m_l_sharetext.node.active=!1,this.m_l_goldlabel.node.parent.active=!0,this.m_btn_suitup.interactable=window.INIT_GAME_SAVE_DATA.gold_num>=e.price),this.m_btn_suitup.node.y=-145):1==this._state?(this.m_l_sharetext.node.active=!1,this.m_l_goldlabel.node.parent.active=!1,this.m_btn_suitup.interactable=!0,this.m_btn_suitup.node.y=-74):(this.m_l_sharetext.node.active=!1,this.m_l_goldlabel.node.parent.active=!1)},e.prototype.onshowback=function(t){this._onshowback&&(t>=window.SHARE_TIME?this.onSuitUp():n.default.showShareFailTips(),this._onshowback=!1)},e.prototype.onSuitUp=function(){if(this.m_btn_suitup.interactable){for(var t=window.INIT_GAME_SAVE_DATA.skin,e=0;e<t.length;e++)if(2==t[e]){window.INIT_GAME_SAVE_DATA.skin[e]=1,window.INIT_GAME_SAVE_DATA.skin[this._index]=2;break}0==this._state&&(0!=this._data.way&&window.SKIN_SHARE?(this._onshowback=!0,o.shareAppMessage({title:"\u83b7\u5f97\u4e86\u4e00\u4e2a\u602a\u517d\u76ae\u80a4\uff0c\u5feb\u6765\u770b\u770b\u5427",imageUrl:window.tempFileURL[1]})):(window.INIT_GAME_SAVE_DATA.gold_num-=this._data.price,EVENT_LISTENER.fire(window.GAME_UPDATE_DATA))),EVENT_LISTENER.fire(window.GAME_SAVE_HANDLER)}},__decorate([a(cc.Label)],e.prototype,"m_l_goldlabel",void 0),__decorate([a(cc.Sprite)],e.prototype,"m_sp_blockstyle",void 0),__decorate([a(cc.Node)],e.prototype,"m_n_isready",void 0),__decorate([a(cc.Button)],e.prototype,"m_btn_suitup",void 0),__decorate([a(cc.Label)],e.prototype,"m_l_sharetext",void 0),__decorate([s],e)}(cc.Component);i.default=r,cc._RF.pop()},{"../common/Common_CommonUtil":"Common_CommonUtil","../common/ShareSdk":"ShareSdk"}],SkinPanel:[function(t,e,i){"use strict";cc._RF.push(e,"7d7b7KFR5ZEOL77nMnw9U+A","SkinPanel"),Object.defineProperty(i,"__esModule",{value:!0});var n=cc._decorator,o=n.ccclass,c=n.property,s=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.m_n_content=null,e.m_pre_skinitem=null,e.m_star0=null,e.m_star1=null,e.m_star2=null,e.m_star3=null,e.m_star4=null,e.m_n_list=[],e}return __extends(e,t),e.prototype.start=function(){EVENT_LISTENER.on(window.GAME_SAVE_HANDLER,this.updateData,this)},e.prototype.initData=function(){for(var t=window.SKIN_CONFIG,e=0;e<t.length;e++){var i=cc.instantiate(this.m_pre_skinitem);i.parent=this.m_n_content,i.getComponent("SkinItem").updateData(e,t[e],this["m_star"+e]),this.m_n_list.push(i)}},e.prototype.updateData=function(){for(var t=window.SKIN_CONFIG,e=0;e<t.length;e++)this.m_n_list[e].getComponent("SkinItem").updateData(e,t[e],this["m_star"+e])},e.prototype.onDestroy=function(){EVENT_LISTENER.off(window.GAME_SAVE_HANDLER,this)},e.prototype.onClose=function(){this.node.active=!1},__decorate([c(cc.Node)],e.prototype,"m_n_content",void 0),__decorate([c(cc.Prefab)],e.prototype,"m_pre_skinitem",void 0),__decorate([c(cc.SpriteFrame)],e.prototype,"m_star0",void 0),__decorate([c(cc.SpriteFrame)],e.prototype,"m_star1",void 0),__decorate([c(cc.SpriteFrame)],e.prototype,"m_star2",void 0),__decorate([c(cc.SpriteFrame)],e.prototype,"m_star3",void 0),__decorate([c(cc.SpriteFrame)],e.prototype,"m_star4",void 0),__decorate([o],e)}(cc.Component);i.default=s,cc._RF.pop()},{}],StepViewItem:[function(t,e,i){"use strict";cc._RF.push(e,"7c6faZ4BVRBNJ+xBP+ShYY7","StepViewItem"),Object.defineProperty(i,"__esModule",{value:!0});var n=t("../common/Common_CommonUtil"),o=t("../common/Utils"),c=t("../common/ShareSdk"),s=cc._decorator,a=s.ccclass,r=s.property,_=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._callback=null,e.m_sp_stepicon=null,e.m_sp_stepname=null,e.m_n_starlist=[],e.m_n_bg=null,e.m_l_steptitle=null,e.m_spa_list=null,e._stepname="",e._onshowback=!1,e}return __extends(e,t),e.prototype.start=function(){EVENT_LISTENER.on(window.ON_SHOW_BACK,this.onshowback,this)},e.prototype.onDestroy=function(){EVENT_LISTENER.off(window.ON_SHOW_BACK,this)},e.prototype.setCloseCallback=function(t){this._callback=t},e.prototype.onClose=function(){this._callback&&this._callback(),this.node.active=!1},e.prototype.onshowback=function(){this._onshowback&&(this._onshowback=!1,this.onClose())},e.prototype.showStep=function(t){for(var e=this,i=this.updateData(t),c=0;c<this.m_n_starlist.length;c++)this.m_n_starlist[c].active=!1;this.m_sp_stepicon.node.getComponent(cc.Animation).play("playstep"),this.m_sp_stepname.node.getComponent(cc.Animation).play("playstep"),this.scheduleOnce(function(){n.default.shakeScreen(e.m_n_bg)},.4);var s=function(t){a.m_n_starlist[t].active=!0,a.m_n_starlist[t].scale=0,a.scheduleOnce(function(){e.m_n_starlist[t].runAction(cc.sequence(cc.scaleTo(.2,1.4,1.4).easing(cc.easeIn(3)),cc.scaleTo(.1,1,1))),o.SetSoundEffect(window.GET_GOLD,!1,1)},.54+.3*(t+1))},a=this;for(c=0;c<i;c++)s(c)},e.prototype.updateData=function(t){void 0===t&&(t=0);var e=Math.floor(t/10),i=window.STEP_CONFIG[e-1],n=0;return i&&(n=i.star,this._stepname=i.desc,this.m_l_steptitle.string=cc.js.formatStr("\u5b8c\u6210%d\u5173 \u6bb5\u4f4d\u63d0\u5347",t),this.m_sp_stepicon.spriteFrame=this.m_spa_list.getSpriteFrame(i.icon_path),this.m_sp_stepname.spriteFrame=this.m_spa_list.getSpriteFrame(i.desc_path)),n},e.prototype.setShowBtnVisible=function(t){for(var e=0;e<this.m_n_starlist.length;e++)this.m_n_starlist[e].active=t;this.m_sp_stepicon.node.active=t,this.m_sp_stepname.node.active=t},e.prototype.onShareStep=function(){this._onshowback=!0,c.shareAppMessage({title:"\u6d88\u9664\u6bb5\u4f4d\u5347\u7ea7\u5230\u3010"+this._stepname+"\u3011,\u4e00\u8d77\u6765\u89c1\u8bc1\u5427",imageUrl:window.tempFileURL[1]})},__decorate([r(cc.Sprite)],e.prototype,"m_sp_stepicon",void 0),__decorate([r(cc.Sprite)],e.prototype,"m_sp_stepname",void 0),__decorate([r([cc.Node])],e.prototype,"m_n_starlist",void 0),__decorate([r(cc.Node)],e.prototype,"m_n_bg",void 0),__decorate([r(cc.Label)],e.prototype,"m_l_steptitle",void 0),__decorate([r(cc.SpriteAtlas)],e.prototype,"m_spa_list",void 0),__decorate([a],e)}(cc.Component);i.default=_,cc._RF.pop()},{"../common/Common_CommonUtil":"Common_CommonUtil","../common/ShareSdk":"ShareSdk","../common/Utils":"Utils"}],SubdomineDisplay:[function(t,e,i){"use strict";cc._RF.push(e,"041f3phw99Aorsmk3RdL7bG","SubdomineDisplay"),Object.defineProperty(i,"__esModule",{value:!0});var n=cc._decorator,o=n.ccclass,c=(n.property,function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.start=function(){this.display=this.node.getComponent(cc.Sprite),this.tex=new cc.Texture2D,this.display.node.active=!0;var t=this;this.schedule(function(){t._updateSubDomainCanvas()},1)},e.prototype._updateSubDomainCanvas=function(){this.node.active&&"undefined"!=typeof wx&&this.tex&&(this.tex.initWithElement(sharedCanvas),this.tex.handleLoadedTexture(),this.display.spriteFrame=new cc.SpriteFrame(this.tex))},e.prototype.onDestroy=function(){this.unscheduleAllCallbacks()},__decorate([o],e)}(cc.Component));i.default=c,cc._RF.pop()},{}],UseToolItem:[function(t,e){"use strict";cc._RF.push(e,"fb269ugEF5GsaQCUfIigkE3","UseToolItem");var i,n=(i=t("../common/Common_CommonUtil"))&&i.__esModule?i:{default:i},o=t("Utils"),c=t("ShareSdk");cc.Class({extends:cc.Component,properties:{m_sp_tool:cc.Sprite,m_n_get:cc.Node,_tag:0,m_sp_desclist:{type:cc.Node,default:[]},m_n_shareget:cc.Node},start:function(){EVENT_LISTENER.on(window.ON_SHOW_BACK,this.onshowback,this),this.m_n_shareget.active=window.BOX_SHARE&&!window.firstshare},initToolInfo:function(t,e){this._tag=t,this.m_n_get.active=e<=0},onCloseClick:function(){this.node.active=!1},onUseClick:function(){0==this._tag||1==this._tag&&window.GAME_CONTROL&&(window.GAME_CONTROL.onUseStrong(),this.onCloseClick())},onAdBtnClick:function(t,e){"undefined"!=typeof wx?wx.getSystemInfoSync().SDKVersion>="2.0.4"?this.showAd(e):(wx.showToast({title:"\u5fae\u4fe1\u7248\u672c\u8fc7\u4f4e\uff0c\u65e0\u6cd5\u770b\u5e7f\u544a",icon:"none",image:"",duration:0}),setTimeout(function(){return wx.hideToast()},2e3)):this.videoReward(e)},showAd:function(t){var e=this;this.m_videoAd||(this.m_videoAd=wx.createRewardedVideoAd({adUnitId:"adunit-e573e466be94d7f5"})),this.m_videoAd.onError(function(){}),this.m_videoAd.load().then(function(){e.m_videoAd.show(),e.m_videoAd.onClose(function(i){e.m_videoAd.offClose(),(i&&i.isEnded||void 0===i)&&e.videoReward(t)})}).catch(function(){return o.showTipsText("\u62c9\u53bb\u89c6\u9891\u5e7f\u544a\u5931\u8d25\uff0c\u8bf7\u7a0d\u5019\u91cd\u8bd5",null,null,null,60,cc.Color.BLACK,1.2)})},videoReward:function(){window.INIT_GAME_SAVE_DATA.tool[this._tag]+=1,o.showGetItem(1,0,null,0,0),window.GAME_CONTROL&&window.GAME_CONTROL.updateToolsNum()},onshowback:function(t){this._onshowback&&(t>=window.SHARE_TIME?(window.firstshare=!0,this.m_n_shareget.active=window.BOX_SHARE&&!window.firstshare,this.videoReward()):n.default.showShareFailTips(),this._onshowback=!1)},onGetClick:function(){window.INIT_GAME_SAVE_DATA.gold_num>=20?(o.showGetItem(1,0,null,0,0),window.INIT_GAME_SAVE_DATA.gold_num-=20,window.INIT_GAME_SAVE_DATA.tool[this._tag]+=1,window.GAME_CONTROL&&window.GAME_CONTROL.updateToolsNum()):o.showTipsText("\u91d1\u5e01\u4e0d\u8db3",null,0,0,60,cc.Color.WHITE)},onDestroy:function(){EVENT_LISTENER.off(window.ON_SHOW_BACK,this),this.m_videoAd&&(this.m_videoAd.destroy(),this.m_videoAd=null)},onShareGet:function(){this._onshowback=!0,c.shareAppMessage({title:"\u5feb\u6276\u7740\u8fd9\u4e2a\u70b8\u5f39\uff0c\u8981\u7206\u5566\uff01\u8981\u7206\u5566\uff01",imageUrl:window.tempFileURL[3]})}}),cc._RF.pop()},{"../common/Common_CommonUtil":"Common_CommonUtil",ShareSdk:"ShareSdk",Utils:"Utils"}],Utils:[function(t,e){"use strict";cc._RF.push(e,"eb7ebzZ/c1Alap1sGhOsN/K","Utils");var i,n=(i=t("../dataStatistics/Data"))&&i.__esModule?i:{default:i};console.log,console.log=function(){};var o={setDesignResolution:function(){var t=cc.find("Canvas").getComponent(cc.Canvas),e=cc.winSize;e.width/e.height>9/16?(t.fitWidth=!1,t.fitHeight=!0):(t.fitWidth=!0,t.fitHeight=!1)},setKVUserData:function(t,e,i,o){1===window.GAME_SAVE_TYPE?cc.sys.localStorage.setItem(t,e):n.default.setData(e,i,o)},getKVUserData:function(t,e,i){if(1===window.GAME_SAVE_TYPE)return cc.sys.localStorage.getItem(t);n.default.getData(e,i)},loadRes:function(t,e,i){cc.loader.loadRes(t,e,function(t,e){t?cc.error(t.message||t):"function"==typeof i&&i(e)})},fadeIn:function(t,e){var i=e||1;t.opacity=0,t.runAction(cc.fadeIn(i))},getSaveData:function(t){if(1===window.GAME_SAVE_TYPE){var e=cc.sys.localStorage.getItem(window.GAME_SAVE_HANDLER);e?window.INIT_GAME_SAVE_DATA=JSON.parse(e):(cc.sys.localStorage.setItem(window.GAME_SAVE_HANDLER,JSON.stringify(window.INIT_GAME_SAVE_DATA)),e=window.INIT_GAME_SAVE_DATA)}else wx.cloud.database({config:{env:window.ENV}}).collection("todos").doc(window.userInfo.openId).get({success:function(e){console.log(e.data),e.data.skin||(e.data.skin=window.SKIN_CONFIG_STATE),window.INIT_GAME_SAVE_DATA=e.data,t&&t(window.INIT_GAME_SAVE_DATA)},fail:function(e){console.log("fail",e),window.need_add=!0,t&&t(window.INIT_GAME_SAVE_DATA)},complete:function(){}})},setSaveData:function(){if(1===window.GAME_SAVE_TYPE)cc.sys.localStorage.setItem(window.GAME_SAVE_HANDLER,JSON.stringify(window.INIT_GAME_SAVE_DATA));else{var t=wx.cloud.database({config:{env:window.ENV}});window.INIT_GAME_SAVE_DATA._id=window.userInfo.openId,window.need_add?t.collection("todos").add({data:window.INIT_GAME_SAVE_DATA,success:function(){window.need_add=!1},fail:function(){}}):t.collection("todos").doc(window.userInfo.openId).update({data:{gold_num:window.INIT_GAME_SAVE_DATA.gold_num,login_time:window.INIT_GAME_SAVE_DATA.login_time,tool:window.INIT_GAME_SAVE_DATA.tool,top_level:window.INIT_GAME_SAVE_DATA.top_level,top_score:window.INIT_GAME_SAVE_DATA.top_score,skin:window.INIT_GAME_SAVE_DATA.skin},success:function(){},fail:function(){}})}},random:function(t,e){return t+Math.floor(Math.random()*(e-t))},getAngle:function(t,e,i,n){var o=Math.abs(t-i),c=Math.abs(e-n),s=c/Math.sqrt(Math.pow(o,2)+Math.pow(c,2)),a=Math.acos(s);return 180/(Math.PI/a)},getRandomSDiff:function(t,e,i){if(e-t+1<i)return[];for(var n=new Array,o=e-t+1,c=0;c<o;c++)n[c]=t+c;for(var s=new Array,a=0;a<i;a++){var r=this.random(0,o-1-a);s[a]=n[r];var _=n[o-1-a];n[o-1-a]=n[r],n[r]=_}return s},showGetItem:function(t,e,i,n,o){this.loadRes("prefabs/textbg",cc.Prefab,function(c){var s=cc.instantiate(c);s.zindex=1e3;var a=s.getChildByName("l_num"),r=s.getChildByName("sp_gold"),_=s.getChildByName("sp_boom");0==e?(a.getComponent(cc.Label).string=cc.js.formatStr("\u7ec8\u6781\u8f70\u70b8x%d",t),r.active=!1,_.active=!0):(a.getComponent(cc.Label).string=cc.js.formatStr("\u91d1\u5e01x%d",t),r.active=!0,_.active=!1);var h=n||0,l=o||0;i&&cc.isValid(i)?s.parent=i:s.parent=cc.find("Canvas"),s.setPosition(h,l),s.setPosition(h,l);var m=cc.moveBy(1.5,cc.v2(0,70)),d=cc.fadeOut(1);s.runAction(cc.sequence(m,d,cc.callFunc(function(){s.destroy()})))})},showTipsText:function(t,e,i,n,o,c,s,a){var r=new cc.Node("tipstext");r.zindex=1e3;var _=r.addComponent(cc.Label);_.fontFamily="\u9ed1\u4f53",_.string=t;var h=i||0,l=n||0;_.fontSize=o||40,_.lineHeight=o?o+10:50,r.color=c||cc.Color.WHITE,e&&cc.isValid(e)?r.parent=e:r.parent=cc.find("Canvas");var m=s||.5,d=a||70;r.setPosition(h,l);var u=cc.moveBy(m,cc.v2(0,d)),p=cc.fadeOut(1);r.runAction(cc.sequence(u,p,cc.callFunc(function(){r.destroy()})))},showHurtText:function(t,e,i,n,o,c,s,a,r){var _=this;this.loadRes("prefabs/l_hurt",cc.Prefab,function(h){var l=cc.instantiate(h);l.zindex=1e3;var m=l.getComponent(cc.Label);m.string=t;var d=i||0,u=n||0;m.fontSize=o||40,m.lineHeight=80,l.color=c||cc.Color.WHITE,e&&cc.isValid(e)?l.parent=e:l.parent=cc.find("Canvas");var p=s||.5,f=a||1;l.setPosition(d,u),_.dir=!_.dir;var w=_.dir?-1:1;r&&(f=0);var v=cc.jumpBy(p,100*f*w,-30,100,1),g=cc.fadeOut(.8);l.runAction(cc.sequence(v,g,cc.callFunc(function(){l.destroy(),l=null})))})},moveIcon:function(t,e,i,n,c,s,a){var r=s||1,_=new cc.Node("iconmove");_.addComponent(cc.Sprite).spriteFrame=t,e&&cc.isValid(e)?_.parent=e:_.parent=cc.find("Canvas");var h=o.random(0,1e3);_.anchorY=0,_.position=i,_.zindex=1e3,a&&a>0?(h>500&&(a*=-1),_.runAction(cc.sequence(cc.jumpBy(.5,a,0,100,1),cc.delayTime(.5),cc.moveTo(r,n).easing(cc.easeIn(3)),cc.callFunc(function(){c&&c(),_.destroy()})))):_.runAction(cc.sequence(cc.moveTo(r,n).easing(cc.easeIn(3)),cc.callFunc(function(){c&&c(),_.destroy()})))},SetSoundEffect:function(t){window.MUSIC_SHOW_OFF&&cc.loader.loadRes(t,cc.AudioClip,function(t,e){window.bgmAudioID=cc.audioEngine.playEffect(e,!1)})},playBgmMusic:function(t,e){this.resumBgmMusic(t,e)},resumBgmMusic:function(t){var e=t||window.BGM;try{window.MUSIC_SHOW_OFF&&(window.bgmAudioID>=0?cc.audioEngine.resume(window.bgmAudioID):setTimeout(function(){cc.loader.loadRes(e,cc.AudioClip,function(t,e){window.bgmAudioID=cc.audioEngine.playMusic(e,!0)})},500))}catch(i){console.error(i),setTimeout(function(){cc.loader.loadRes(e,cc.AudioClip,function(t,e){window.bgmAudioID=cc.audioEngine.playMusic(e,!0)})},500)}},stopBgmMusic:function(){try{void 0!==window.bgmAudioID&&cc.audioEngine.pause(window.bgmAudioID)}catch(t){console.warn(t)}},formatSecToTime:function(t){var e;if(t>-1){var i=Math.floor(t/3600),n=Math.floor(t/60)%60,o=t%60;e=i<10?"0"+i+":":i+":",n<10&&(e+="0"),e+=n+":",o<10&&(e+="0"),e+=o}return e},getMin:function(t,e){return t>e?e:t},getMax:function(t,e){return t>e?t:e},getMiddleIndex:function(t,e,i){var n=e-t;return n%2==0?n/2+t:i?Math.ceil(n/2)+t:Math.floor(n/2)+t}};e.exports=o,cc._RF.pop()},{"../dataStatistics/Data":"Data"}],Wave_VH:[function(t,e){"use strict";cc._RF.push(e,"47130Ahq4RMiql9ilrh/oye","Wave_VH");var i=t("./ccShader_Default_Vert.js"),n=t("./ccShader_Default_Vert_noMVP.js"),o=t("./ccShader_Wave_VH_Frag.js");cc.Class({extends:cc.Component,properties:{},onLoad:function(){this._angle=15,this._motion=0,this._use()},_use:function(){this._program=new cc.GLProgram,cc.sys.isNative?(cc.log("use native GLProgram"),this._program.initWithString(n,o),this._program.link(),this._program.updateUniforms()):(this._program.initWithVertexShaderByteArray(i,o),this._program.addAttribute(cc.macro.ATTRIBUTE_NAME_POSITION,cc.macro.VERTEX_ATTRIB_POSITION),this._program.addAttribute(cc.macro.ATTRIBUTE_NAME_COLOR,cc.macro.VERTEX_ATTRIB_COLOR),this._program.addAttribute(cc.macro.ATTRIBUTE_NAME_TEX_COORD,cc.macro.VERTEX_ATTRIB_TEX_COORDS),this._program.link(),this._program.updateUniforms()),this._uniMotion=this._program.getUniformLocationForName("motion"),this._uniAngle=this._program.getUniformLocationForName("angle"),this._mouse=this._program.getUniformLocationForName("mouse"),cc.sys.isNative?cc.GLProgramState.getOrCreateWithGLProgram(this._program).setUniformFloat(this._uniAngle,this._angle):this._program.setUniformLocationWith1f(this._uniAngle,this._angle),this.setProgram(this.node._sgNode,this._program)},setProgram:function(t,e){if(cc.sys.isNative){var i=cc.GLProgramState.getOrCreateWithGLProgram(e);t.setGLProgramState(i)}else t.setShaderProgram(e);var n=t.children;if(n)for(var o=0;o<n.length;o++)this.setProgram(n[o],e)},update:function(){this._program&&(this._program.use(),cc.sys.isNative?cc.GLProgramState.getOrCreateWithGLProgram(this._program).setUniformFloat(this._uniMotion,this._motion+=.02):(this._program.setUniformLocationWith1f(this._uniMotion,this._motion+=.02),this._program.updateUniforms()),1e20<this._motion&&(this._motion=0))}}),cc._RF.pop()},{"./ccShader_Default_Vert.js":"ccShader_Default_Vert","./ccShader_Default_Vert_noMVP.js":"ccShader_Default_Vert_noMVP","./ccShader_Wave_VH_Frag.js":"ccShader_Wave_VH_Frag"}],Wxlife:[function(t,e){"use strict";cc._RF.push(e,"8fd3eIEt5VPG7r1OkVzTLWV","Wxlife");var i,n=(i=t("./event_listener"))&&i.__esModule?i:{default:i},o=t("Utils");window.EVENT_LISTENER=(0,n.default)({});var c=!1;window.firstGame=!0,window.firststart=!1,window.getdata=!1,window.need_add=!1,window.firstshare=!1,window.firstvideo=!1;var s=0;cc.view.enableRetina(!0),"undefined"!=typeof wx&&(wx.onHide(function(){c=!0,window.getdata&&o.setSaveData(),s=(new Date).getTime()}),wx.onShow(function(t){if(c){o.resumBgmMusic();var e=(new Date).getTime();EVENT_LISTENER.fire(window.ON_SHOW_BACK,e-s)}t.query.group&&(window.SHOW_RES=t,EVENT_LISTENER.fire(window.GAME_RANK_LISTENER))})),cc._RF.pop()},{"./event_listener":"event_listener",Utils:"Utils"}],ccShader_Default_Vert_noMVP:[function(t,e){"use strict";cc._RF.push(e,"0644fQ5ZXFCqq9x2DCKfyIi","ccShader_Default_Vert_noMVP"),e.exports="\nattribute vec4 a_position;\n attribute vec2 a_texCoord;\n attribute vec4 a_color;\n varying vec2 v_texCoord;\n varying vec4 v_fragmentColor;\n void main()\n {\n     gl_Position = CC_PMatrix  * a_position;\n     v_fragmentColor = a_color;\n     v_texCoord = a_texCoord;\n }\n",cc._RF.pop()},{}],ccShader_Default_Vert:[function(t,e){"use strict";cc._RF.push(e,"82ac0wtVkVK/K0KFo+pzlyg","ccShader_Default_Vert"),e.exports=" \nattribute vec4 a_position;\nattribute vec2 a_texCoord;\nattribute vec4 a_color;\nvarying vec4 v_color;\nvarying vec2 v_texCoord;\nvoid main()\n{\n    gl_Position = CC_PMatrix * a_position;\n    v_texCoord = a_texCoord;\n    v_color = a_color;\n}\n",cc._RF.pop()},{}],ccShader_Wave_VH_Frag:[function(t,e){"use strict";cc._RF.push(e,"c1487nMlJ5MI52WhD6w5kod","ccShader_Wave_VH_Frag"),e.exports="\n#ifdef GL_ES\nprecision mediump float;\n#endif\nvarying vec2 v_texCoord;\nuniform float motion;\nuniform float angle;\nvoid main()\n{\n    vec2 tmp = v_texCoord;\n    tmp.x = tmp.x + 0.01 * sin(motion +  tmp.x * angle);\n    // tmp.y = tmp.y + 0.01 * sin(motion +  tmp.y * angle);\n    gl_FragColor = texture2D(CC_Texture0, tmp);\n    \n}\n",cc._RF.pop()},{}],ccShader_wave:[function(t,e){"use strict";cc._RF.push(e,"ba386OeeWFMXZpyuzJR95fV","ccShader_wave"),e.exports="\n#ifdef GL_ES\nprecision mediump float;\n#endif\n\nvarying vec2 v_texCoord;\nuniform float time;\nuniform vec2 mouse;\nfloat PI = 3.1415926;\n\nfloat _distanceFactor = 100.0;  \nfloat _timeFactor = -30.0;  \nfloat _totalFactor = 1.0;  \nfloat _waveWidth = 0.1;  \nfloat waveSpeed = 0.3;\nvoid main() {\n\tfloat _curWaveDis = time*waveSpeed;\n\t//\u8ba1\u7b97uv\u5230\u9f20\u6807\u70b9\u51fb\u70b9\u7684\u5411\u91cf(\u5411\u5916\u6269\uff0c\u53cd\u8fc7\u6765\u5c31\u662f\u5411\u91cc\u7f29) \n\tvec2 dv = mouse.xy - v_texCoord.xy;\n\t//\u6309\u7167\u5c4f\u5e55\u957f\u5bbd\u6bd4\u8fdb\u884c\u7f29\u653e\n\tdv = dv*vec2(0.5625,1.0);\n\tfloat dis = sqrt(dv.x * dv.x + dv.y * dv.y);  \n\tfloat sinFactor = sin(dis * _distanceFactor + time * _timeFactor) * _totalFactor * 0.005;  \n\tfloat discardFactor = clamp(_waveWidth - abs(_curWaveDis - dis), 0.0, 1.0) / _waveWidth;\n\tvec2 dv1 = normalize(dv);  \n\t//\u8ba1\u7b97\u6bcf\u4e2a\u50cf\u7d20uv\u7684\u504f\u79fb\u503c  \n\tvec2 offset = dv1  * sinFactor * discardFactor;\n\tvec2 uv = offset+v_texCoord.xy;\n\tgl_FragColor = texture2D(CC_Texture0, uv);\n}\n",cc._RF.pop()},{}],event_listener:[function(t,e,i){"use strict";cc._RF.push(e,"c0e844NcElKPp+0tkp+hKuL","event_listener"),i.__esModule=!0,i.default=void 0;i.default=function(t){var e={};return t.on=function(t,i,n){e.hasOwnProperty(t)||(e[t]=[]);var o={};o.func=i,o.target=n,e[t].push(o)},t.fire=function(t){if(e.hasOwnProperty(t))for(var i=e[t],n=0;n<i.length;n++){for(var o=i[n],c=[],s=1;s<arguments.length;s++)c.push(arguments[s]);o.func?o.func.apply(o.target,c):trace("[Warn] \u6ca1\u6709\u5bf9\u5e94\u7684\u56de\u8c03\u4e8b\u4ef6\u7c7b\u578b - "+t)}},t.off=function(t,i){if(e.hasOwnProperty(t))for(var n=e[t],o=0;o<n.length;o++)n[o].target===i&&n.splice(o,1)},t},e.exports=i.default,cc._RF.pop()},{}],launch:[function(t,e){"use strict";cc._RF.push(e,"258ccpxWURAypXp2UAOUMHy","launch");var i=t("ShareSdk"),n=t("Utils"),o=t("RankList");cc.Class({extends:cc.Component,properties:{m_sp_rank_mask:cc.Node,display:cc.Sprite,rankCloseBtn:cc.Node,playGameBtn:cc.Node,groudGameBtn:cc.Node},start:function(){this.tex=new cc.Texture2D,this.display.node.active=!1,this.m_sp_rank_mask.active=!1,this.isShow=!1,EVENT_LISTENER.on(window.GAME_RANK_LISTENER,this.rankUpdate,this),this.isshowtrue=!0,this.rankUpdate()},onEnable:function(){this.rankUpdate()},onDisable:function(){window.SHOW_RES=null},onDestroy:function(){EVENT_LISTENER.off(window.GAME_RANK_LISTENER,this)},rankUpdate:function(){window.SHOW_RES&&window.SHOW_RES.query.group&&(this.ShowGroudRankClick({query:window.SHOW_RES.query,shareTicket:window.SHOW_RES.shareTicket}),this.isshowtrue&&(window.SHOW_RES=null))},onClick:function(){n.SetSoundEffect(window.BUTTON_CLICK_MUSIC,!1,1),this.rankCloseBtn.active=!0,this.groudGameBtn.active=!0,this.isShow=!0,window.GAME_MENU&&window.GAME_MENU.showAdBanner(!1),this.display.node.active=this.isShow,this.m_sp_rank_mask.active=this.isShow,o.showFriendList()},onGroudBtnClick:function(){n.SetSoundEffect(window.BUTTON_CLICK_MUSIC,!1,1),i.shareAppMessage({title:"\u6211\u5df2\u7ecf\u6d88\u706d\u4e86N\u4e2a\u602a\u517d\u4e86\uff0c\u4f60\u5462\uff1f\u5feb\u6765\u770b\u770b\u6392\u540d",imageUrl:window.tempFileURL[1],query:"group=2",success:function(){},fail:function(){},complate:function(){}})},onCloseClick:function(){n.SetSoundEffect(window.BUTTON_CLICK_MUSIC,!1,1),this.isShow=!1,this.display.node.active=!1,this.m_sp_rank_mask.active=this.isShow,this.playGameBtn.active=!1,this.groudGameBtn.active=!1,this.rankCloseBtn.active=!1,window.GAME_MENU&&window.GAME_MENU.showAdBanner(!0)},onPlayGameClick:function(){n.SetSoundEffect(window.BUTTON_CLICK_MUSIC,!1,1),this.isShow=!1,cc.director.loadScene(window.GAME_SCENE_NAME)},_updaetSubDomainCanvas:function(){this.tex&&(this.tex.initWithElement(sharedCanvas),this.tex.handleLoadedTexture(),this.display.spriteFrame=new cc.SpriteFrame(this.tex))},update:function(){"undefined"!=typeof wx&&this._updaetSubDomainCanvas()},ShowGroudRankClick:function(t){n.SetSoundEffect(window.BUTTON_CLICK_MUSIC,!1,1),window.GAME_MENU&&window.GAME_MENU.showAdBanner(!1),t.query&&t.shareTicket&&(o.showGroupList(t.shareTicket),this.isShow=!0,this.display.node.active=this.isShow,this.m_sp_rank_mask.active=this.isShow,this.rankCloseBtn.active=!0,this.playGameBtn.active=!1,this.groudGameBtn.active=!1)}}),cc._RF.pop()},{RankList:"RankList",ShareSdk:"ShareSdk",Utils:"Utils"}],use_reversed_rotateBy:[function(t,e){"use strict";cc._RF.push(e,"9d065u3y5lBqYzBDaDRmfQ/","use_reversed_rotateBy"),cc.RotateBy._reverse=!0,cc._RF.pop()},{}],"use_v2.0.x_cc.Toggle_event":[function(t,e){"use strict";cc._RF.push(e,"f545bjtIEBPL6qmomFczjsC","use_v2.0.x_cc.Toggle_event"),cc.Toggle&&(cc.Toggle._triggerEventInScript_check=!0),cc._RF.pop()},{}]},{},["GameLoad","GameMain","GameMenu","GameResult","GameStep","BgSetting","Common_CommonUtil","GameEndRank","GuideManager","PlatformCom","RankList","ReliveViewCtrl","ShareSdk","SubdomineDisplay","Utils","Wxlife","event_listener","launch","EffectCommon","Wave_VH","ccShader_Default_Vert","ccShader_Default_Vert_noMVP","ccShader_Wave_VH_Frag","ccShader_wave","Data","PureMVC","BgItem","BigStepItem","BlockBGItem","BlockItem","BombEffectItem","GetBoxGiftItem","MonsterItem","RockItem","ShapeItem","ShareTipsItem","SkinItem","SkinPanel","StepViewItem","UseToolItem","NewBieGift","use_reversed_rotateBy","use_v2.0.x_cc.Toggle_event"]);